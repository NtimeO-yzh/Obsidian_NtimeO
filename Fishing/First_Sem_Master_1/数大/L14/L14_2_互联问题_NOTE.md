[[Fishing/First_Sem_Master_1/数大/数大|数大]]
# 一、引言
## 1.互连带来的影响 
- 互连带来的影响
	- 稳定性降低:耦合
	- 延时增加:R
	- 功耗增加:R
- 寄生效应类型
	- 电容性
	- 电阻性
	- 电感性
# 二、电容寄生效应
由相邻的信号线与电路节点之间不希望有的耦合引起的干扰通常称为串扰（cross talk）。<font color="#ff0000">其所导致的干扰如同一个噪声源，会引起难以跟踪的间断出错，因为所注人的噪声取决于在相邻区域上布线的其他信号的瞬态值。</font>在集成电路中，这一信号间的耦合可以是电容性的和电感性的（见图1.10），但在当前的开关速度下，电容性的串扰是主要因素。在设计混合信号电路的输入/输出电路时电感耦合是主要的考虑因素，但这在数字设计中目前还不是一个问题。 电容性串扰可能产生的效应受所考虑导线的阻抗的影响。如果该线是浮空的，那么由耦合引起的干扰就会持续存在并且可能会因邻近导线上后续的切换而变得更糟。*反之，如果导线是被驱动的，那么信号会回到其原来的电平。*
### (1)浮空线
考![[support/img/Pasted image 20240115150718.png#right|浮空线|200]]虑图9.1 的电路结构。线$X$通过寄生电容$C_{xr}$与线$Y$耦
合。线$Y$至地的总电容等于$C_{Y}$假设节点$X$处的电压发生了一个等于$\Delta V_x$的阶跃变化，这一阶跃在节点 Y 处<font color="#ff0000">因电容分压</font>而衰减：$$\Delta V_Y=\frac{C_{XY}}{C_Y+C_{XY}}\Delta V_X$$
> **如何解释这个公式?**
> X是主动变化的, X上的改变了一个值, 因此X处的电荷变了, 因此, 上极板的电荷变了, 下极板也应该变化, 因此, 分母就是下极板处的电容.因此有了这个式子

上边这个式子告诉我们, Vx变化越大, 浮空线上的电压变化就越大
因此, 易受到电容串扰的电路有以下两种特点
- 动态电路
- 低摆幅电路：特别是在全摆幅导线附近的<font color="#ff0000">低摆幅预充电</font>电路
### (2)被驱动线
一如果线$Y$被一个内阻为$R_\mathrm{y}$的信号源驱动，线$X$上的阶跃变化就会引起线$Y$上的瞬态响应， ==如图9.3( $a$) $所示，这一瞬态响应以时间常数$$\tau_{XY}=R_Y(C_{xY}+C_Y)$衰减==。
对“受害线”的实际影响与干扰信号的上升(下降)时间有很大关系。如果上升时间近似或大于上述时间常数，那么干扰的峰值就会减小。这可以从图 9.3(b)的模拟波形看出。显然，保持导线的驱动阻抗(因而 $\tau_{xY}$)较

低对降低电容串扰的影响有很大帮助。在一个动态栅或预充电导线上加一个保持晶体管( keeper)是通过降低阻抗来控制噪声的绝好例⼦。*(前边咋不加Keeper)*

总之，串扰对被驱动节点上信号完整性的影响是⾮常有限的。其造成的⽑刺可能引起后⾯ 连接的元件操作错误，因⽽应当⼗分⼩⼼。然⽽其最軍要的匙响是加⼤了延时，这⼀点将在以后 讨论。
 ![[support/img/Pasted image 20240115151736.png|500]]
> 这里的意思是, 假设我因为上边的X节点的电压变化, 导致下边的电荷也变了, 但由于我有一片大海, 也就是驱动信号, 我可以把多的电荷给驱动, 或者从驱动之中拿来一些电荷, 最终保持我这一片小湖泊和大海等高(电压相同)就可以. 
> 那么, 我这个电荷通过的路径, 就上边就会有一个R限制电流, 因此, R越大, 我这个受害者的回复就越慢.
> 因此也就说, 我干扰信号的变化速率慢了好, 你对我的干扰我能立即通过R弥补.
> ==浮空就是R无穷了==
### (3)解决措施

1. 避免浮空节点，对浮空节点增加keeper以降低阻抗
![[support/img/Pasted image 20240115133943.png|400]]
2. 保护敏感节点，使之能很好的与全摆幅信号隔离
3. 在满足时间约束的条件下，信号上升和下降时间尽可能大 
	- 注意：这种情况下MOS管的短路功耗会增加
4. 采用传输差分信号的方法. *这能使串扰信号变为不会影响电路⼯作的共模噪声源。*
5. 避免导线长距离走在一起
	1. 增加并行走线的导线间的间距
	2. 相邻层的导线应当相互垂直
6. **合理布线**，利用电源线和地线使敏感节点与全摆幅信号隔离
	1. *在导线的一边布置电源线或地线*
	2. *在导线的两边布置电源线和地线*
	3. *将导线相互交叉，使相邻导线不在同一时刻翻转*![[support/img/Pasted image 20240115152108.png]]
7. 在**上下层之间**增加额外的金属屏蔽层隔离，以进一步减少上下 层之间的线间电容, *它能有效地使线间电 容转变为⼀个接地电容，从⽽消除⼲扰。屏蔽的不利影响是增加了电容负载*。![[support/img/Pasted image 20240115152228.png|500]]
8. *采用中继器（Repeater）或者缓冲器（Buffer）：加大驱动 强度，以减少对串扰的敏感程度*![[support/img/Pasted image 20240115152313.png|500]]
9. *采用交错布置的中继器（Staggered Repeater）*![[support/img/Pasted image 20240115152330.png|500]]
10. *利用电荷补偿*![[support/img/Pasted image 20240115152347.png|500]]
11. *将差分信号“绞合”（Twisted）*![[support/img/Pasted image 20240115152406.png|500]]
### (4)串扰与性能
由于串扰使导线<font color="#ff0000">延时越来越难以预计</font>，设计者可以选⽤许多不同的⽅法來解决这⼀问题，包 括以下这些⽅法。
一、估计和改进
- 参数提取>模拟>修改>提取…. 
- 多次反复，设计时间长
二、能动性的版图生成
- 布线程序中考虑相邻线的影响
- 要求设计工具复杂，目前无法有效实现
==三、可预测的结构==
- ==预定义的、已知的或保守的布线结构，保证性能和可靠性==
- ==目前唯一真正可行的方法==
四、避免最坏情形
- 消除或避免引起最坏延时情形的导线翻转
#### A:预定义不限结构
- 定![[support/img/Pasted image 20240115152830.png#right|预定义结构|200]]义最小线宽和间距
- 使得相邻层导线相互垂直
- 使用同一层上的信号用 VDD 或 GND 屏蔽技术
Trade-off
-  线间交叉<font color="#ff0000">耦合电容降低</font>到1/40， 只有 2% 延时变化（延时差别变小）
- 总电容和面积增加 5%
- 总延时增加
### (5)电容负载和电路性能
**🏀什么情况下需要用单个门驱动大的电容？**
<font color="#ff0000">互连电容值的增加，特别是全局连线电容值的增加，使得更需要能以⾜够快的速度对电容进⾏充(放)电的⾼效驱动电路。</font>这⼀需要由于以下事实变得更为突出，即在复杂的设计中单个⻔ 常常需要驱动很⼤的扇出，因⽽具有很⼤的电容负载。⽚上⼤负载的典型例⼦有
 - 总线
 - 时钟⽹络
 - 控制线, 包括复位(reset）和置位(set)信号。
这些信号控制着⼤量⻔的操作，所以扇出通常很大。其他大扇出的例子可以在**存储器**中遇到，那里有大量的存储单元连接到一小组控制线和数据线上。这些节点的电容很容易达到几皮法的范围。**最坏情况发生在当信号送出芯片的时候**。这时负载由封装导线、印刷电路板导线以及所连接的 IC 或部件的输人电容组成。片外负载可以大至50pF，这比一个标准的片上负载要大数千倍。因此能以足够快的速度驱动这些节点成为最关键的设计问题之一。
**🏀如何选择晶体管来驱动大的电容负载：**
1.  选择合适晶体管尺寸
2.  把驱动器分为逐级增大的缓冲器链
> 第一段的叙述是说, 大电容确实存在, 现在要解决的问题是, 如何以更快地速度给这些电容充放电, 也就是延时最小, 这就弄到了之前的内容

**🏀 几个重要结论：**
- 多级驱动器设计中，延时应平均分配到每一级（每级具有相同的 等效扇出 f ）
- 每一级的延迟为：$$t_p=t_{p_0}(1+\frac f\gamma)$$
	-  若多级缓冲器链的级数 N 固定，则：$$f=\sqrt[N]{F}\quad\quad\quad(F=\frac{C_L}{C_{g,1}})$$
	-  如果级数 N 可以自由选择，则：
$\gamma=0$时，每级扇出系数$f$为e 时延时最小； 
$\gamma=1$时，每级扇出系数$f$大约为3.6(通常选择$f=4)$ 时延时最小。
🌰🌰🌰🌰🌰🌰🌰🌰🌰🌰
![[support/img/Pasted image 20240115153553.png|500]]
![[support/img/Pasted image 20240115153610.png|500]]
因此, 出现了问题,  最大晶体管宽度达到 1.5mm ! 总尺寸是最小反相器尺寸的数千倍 !!!!!!!!!!!!!!!!
因此想到, 能否通过降低性能（速度）要求，换取面积和能量的减少？指定最大允许的传播延时$t_{p,max}$,求出满足下面限制的相对于面积和能量最优的$f$和${N}:$$$t_{p,\max}\geq t_{p_0}\times\ln(F)\frac{1+f/\gamma}{\ln(f)}=t_{_{p_0}}\times N\times\left(1+\frac{F^{1/N}}\gamma\right)$$
> 上边这式子吗就是N级的表达式, 只不过还用了N级延时相等的概念


根据公式$$\frac{t_p}{t_{p0}}=N\times\left(1+\frac{F^{1/N}}\gamma\right)$$

![[support/img/Pasted image 20240115154907.png]]

**🏀因此问题变为: 如何选取 f 和 N(其实就是怎么选N, 因为F定了, N有了, f也有了) ？**
1. 面积$$A_{driver}=\left(1+f+f^2+...+f^{N-1}\right)A_{min}=\frac{f^{N}-1}{f-1}A_{min}=\frac{F-1}{f-1}A_{min}$$简⾔之，驱动器的⾯积近似地与锥形(逐级增⼤）的尺⼨系数f 成反⽐。选择较⼤的f值有助 于显著降低⾯积成本。
> 时序约束条件下*使缓冲器⾯积最⼩时，保持扇出系数f不变实际上并不是⼀个最佳解快办法。*逐级增加扇出系数 能够提供更好的结果。我们特在第11 章中再次简要讨论该问题。
2. 能量
   还有一点值得提及，即以指数形式增大的缓冲器对能量消耗的影响。虽然只需消耗等于$C_{\iota}V_{oo}^{2}$的能量就能切换负载电容，<font color="#ff0000">但驱动器本身还需要消耗能量以切换它的内部电容( 忽略短路能耗)</font>。驱动器的额外能量消耗可近似表示成下列表达式：$$\begin{aligned}E_{driver}&=(1+f+f^{2}+\ldots+f^{N-1})(1+\gamma)C_{i}V_{DD}^{2}\\&=\left(\frac{F-1}{f-1}\right)(1+\gamma)C_{i}V_{DD}^{2}\approx\frac{2C_{L}}{f-1}V_{DD}^{2}\end{aligned}$$
   - $\gamma\approx1$
   - $(F-1)C_i\thickapprox C_L$, $F本来就是扇出, C_i是第一级的输入电容, 所以F变为F-1还好吧$
这意味着快速驱动⼤电容(即采⽤f=3.6的最优锥形系数）较末缓冲的情况多消耗 80% ==(因为2/2.6约为0.8)==的能量。对于 ⼤的负载电容来说，这是⼀个很⼤的开销。*降低这⼀最优的锥形系数*有助于减少这⼀额外的消耗。*????????????降低???????????*
> [!question] 这个式子怎么来的???
> $f$不说了, 面积嘛.这个$1+\gamma$是什么东西????
> $\gamma$的定义为: ![[support/img/Pasted image 20240115154409.png|400]]
> 因此, 每一个反相器提供的电容就是, 输入电容和输出电容, 也就是($1+\gamma$)倍*的某级输入电容*

结果如下!!!!
![[support/img/Pasted image 20240115155600.png]]
### (6)大尺寸（宽度）晶体管版图设计
<span style="background:#d3f8b6">插指结构</span>, *没看懂为啥是一样的, 就是为啥*
使是这⼀重新设计的缓冲器也需要较宽的晶体管，在设计这些器件时必须⼗分⼩⼼，因为 ⼤的 ⼜值意味着⾮常长的栅连线。较长的多晶线通常有较⾼的电阻，从⽽降低了开关性能。这 个问题可以⽤以下办法来解决：⼀个宽的晶体管可 以通过并联许多较⼩的晶体管(也称为“指状”晶体管）来构成(⻅图 9.9）。
![[support/img/Pasted image 20240115155727.png]]
# 三、电阻寄生效应
**🏀电阻寄生效应的影响**
1. 可靠性：电阻的影响常见于电源分布网络中
	1. **IR（欧姆）电压降:** 电流流经⼀条有电阻的导线时会导致欧姆电压降，从⽽降低了信号电平。这在电源分布⽹ 络中尤为重要，因为在那⾥电流能够很容易达到安培级，
	2.  **电迁移**: ⾦属导线上的电流密度（单位⾯积的电流）受到电 迁移效应的限制。<font color="#ff0000">在⼀条⾦属线上较⻓时间地通过直流电 流会引起⾦属离⼦的移动。</font>这最终会导致导<font color="#ff0000">线断裂或与另⼀条导线短路</font>。这类 故障只发⽣在器件已使⽤了⼀段时间之后。
	3. 电源网络分布应该使得IR电压降最小，同时由于电路开关动作引起的电流波动尽可能小
2. 性能：RC延时
## 1. 电压降
![[support/img/Pasted image 20240115160127.png]]

![[support/img/Pasted image 20240115160811.png|500]]图中把一个离电源和地引线(Pin)都很远的反相器连接到一个接近电源的器件上。由在电源地线上 IR 电压降引起的逻辑电平差可能使晶体管 $M_{1}$ 部分导通==(md电流使得电压升高, 但还叫电压降)==。这可能引起一个预充电的动态节点 $X$ 意外放电，或者如果连接的门是静态的，则有可能引起静态功耗。总之，来自片上逻辑和存储器
### (1)电源和地线分布
![[support/img/Pasted image 20240115160905.png|500]]
### (2)布线方案举例
电源布线方案取决于可用于电源分布的宽线金属层 （即厚的、节距大的、最上面的金属层）的数目
![[support/img/Pasted image 20240115160922.png|400]]
### (3)例子
![[support/img/Pasted image 20240115161021.png|500]]
![[support/img/Pasted image 20240115161037.png|500]]
## 2. 电迁移
在一条金属线上较长时间地通过直流电流会引起金 属离子的移动，最终导致导线断裂或与另一条导线短路。
 ![[support/img/Pasted image 20240115161131.png|500]]
 - 电迁移失效率与温度、晶格结构和电流密度相关
	 - 设计时，电源线的最小宽度应考虑电迁移问题， 一般要求电源线上电流密度在 1mA / um以下
- 工艺层次上减小电迁移的方法：
	- 在 Al 中掺入合金元素（如 Cu 或者 Tu）以阻挡 铝离子的运动
	- 采用新的互连材料（控制离子的粒度），例如用 Cu 代替 Al
	- 

## 3. 电阻和性能-—RC 延时
![[support/img/Pasted image 20240115161334.png|500]]
> [!question] 插入中继器到底怎么算???????
> 
# 四、高级互连技术
## 1. 降摆幅电路
### (1)减小信号摆幅的影响:
1. 延时线性减少
2. 功耗降低
3. 对其他节点的干扰会减少
4. 噪声容限会降低: 影响到信号的完整性和可靠性
### (2)实现手段
![[support/img/Pasted image 20240115161526.png|400]]
### (3)分类
- 静态和动态（预充电的）
- 单端（接收器探测总线上电压的绝对变化）和双端 （同时传送信号和其反信号，接收器探测两条线间电 压的相对变化）
#### A: 降摆幅电路（静态单端）
##### a:第一种
![[support/img/Pasted image 20240115161725.png]]
**驱动器**就是俩接比较低的$V_{DD}$的反相器串联

**接收器**的工作原理: 有点像作业题, 假设来了个弱1, 那么, 左下角的NMOS的电阻很大, 右下角的NMOS电阻很小, 这就把OUT ' 拉的更高了, 把Out拉的更低了, 这就使得上边那俩的电阻也变化, 正反馈了. 
*<span style="background:#d3f8b6">为啥没有静态功耗????</span>*

##### b:第二种
![[support/img/Pasted image 20240115162250.png]]
NMOS弱1, <span style="background:#d3f8b6">PMOS弱0</span>对吧, 很重要的是, A会被P1拉高, 但是N1不导通, 导致B也就有个弱1
<span style="background:#d3f8b6">另一种情况一样的</span>

# 五、总结
![[support/img/Pasted image 20240115163154.png|500]]