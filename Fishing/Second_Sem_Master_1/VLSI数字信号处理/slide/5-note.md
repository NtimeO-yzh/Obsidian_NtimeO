第3章并行处理部分 
• 未讲硬件复制后 
- 边的连接规则
- 延迟分配规则
如右图
- 只给出了结果![[support/img/Pasted image 20240326101529.png|400]]
# 引言
**展开的定义**: 
*展开*(Unfolding)：是一种转换技术，它产生一个新的程序来描述原有程序的多( J )次迭代，J称为展开因子，表示迭代次数
- 例子
对DSP程序$y(n)=ay(n-9)+ x(n)$进行2阶展开：
$设n=2k,$
$y(2k)=ay(2k-9)+ x(2k)= ay((2(k-5)+1)+ x(2k)$
$y(2k+1)=ay(2k-8)+ x(2k+1)= ay((2(k-4)+0)+ x(2k+1)$     
见纸质笔记
## 环路展开
### 展开环路的规则
![[support/img/Pasted image 20240326173355.png]]
> [!question] 拷贝是什么东西

### 环路展开的影响
![[support/img/Pasted image 20240326173442.png]]
> [!question] 这里的$w_{l}$是什么

### 展开和重定时
 ![[support/img/Pasted image 20240326173548.png]]
 意思就是, 我要求了一个c, 但是你非得展开, 那我没办法, 重定时之后我必须要求边的延迟大于G才能保证展开之后不会出现0延迟边
 > [!question] 那对于其余的满足c的, 万一D的数量小于J, 那万一展开之后成为关键路径了咋办
 
### 如何使展开后的$T_{s}$逼近迭代边界
#### (1)重定时和展开对于减少$T_{s}$的作用
![[support/img/Pasted image 20240326173943.png]]
 ![[support/img/Pasted image 20240326174007.png]]
#### (2) 如何展开成为理想速率的DFG
- 什么是理想速率的DFG: 每一条==*环路*==的延迟都为1的DFG，称为理想速率DFG
- 根据关键环路进行展开: 
	- 设$l$为关键环路. 选$J=kw_{l}$  , 其中$k=1,2,\dots$也就是说, 展开级数是关键环路的D总数的正整数倍
	- 展开后, 根据前边的公式, 关键环路复制为$gcd(w_{l},J)=w_{l}$个环路, 环路上的每个节点拷贝了$\frac{J}{gcd(w_{l},J)}=k$, 每个换路由的总延迟数变为${w_{l}}^`=\frac{w_{l}}{gcd}=1$(变为总延迟数为1的$w_{l}$个环路, 且==**属于每个环路**==上的每个节点复制$k$倍)
	- **==若关键路径在此环路==**, (什么时候在, 什么时候不在), 则$T^{'}_{it}=\frac{T^{'}_{c}}{J}$. 这个式子的意思指, 这个环路的关键路径➗一个周期进来的sample数量就等于这个环路的迭代周期, 也就是采样一个点需要的时间, 那么继续计算$T^{'}_{it}=\frac{T^{'}_{c}}{J}$, 由于整个环路上只有一个D, 而且环路的节点数量被复制了$k$倍,  因此, 若假设G中该环路的环路计算时间为$T_{l}$则展开后的每一个对应环路的数量应该为$k\times T_{l}$. 此时再带入$J=kw_{l}$, 则得到,$$T'_{it}=T'_{c}/J=(kT_{l})/(kw_{l})=T_{\infty}$$
	 这就说明, 展开的阶数为$kw_{l}$的时候,采样周期(迭代周期)能够达到原图的迭代边界.
	- 但是, **==有可能关键路径不在此环路上==**, 因此, $T^{'}_{c}\geq kT_{l}$, 此时的采样速率大于$T_{\infty}$
- 结论: ![[support/img/Pasted image 20240326184421.png]]
# 展开的应用
在以下三种情况下, J的选择：使关键环路达到理想速率
1. 情况1: 原始DFG中存在计算时间$T_{U}>T_{\infty}$的节点，下图例子![[support/img/Pasted image 20240326190248.png]]按之前的来说, J只需要是 $w_l$的正整数倍就可以了, 不需要对 $T_c/T_l$向上取整, 而且对于这里的 $T_{l}$的含义也不是非常的明晰, **==是关键路径环路还是计算时间最长的环路==**?![[support/img/Pasted image 20240326192438.png]]![[support/img/Pasted image 20240326192457.png]]
字串行, 字并行,位串行,字并行;
字并行不太好说, 有一页ppt![[support/img/Pasted image 20240326204522.png]]
我也不懂一个输入样点为什么能是一个字.而且这里也说了字串行, 不知道和下一页的字串行是不是一样的. 
1. 位并行: 一个W位的字在一个时钟周期内处理完.
2. 位串行: 一个周期处理一位, W位的字在W个时钟周期内处理完
3. 字串行:一个时钟周期处理N位, 在W/N个时钟周期内处理完W位
# 带开关边U$\to$V的展开
![[support/img/Pasted image 20240326204942.png]]
![[support/img/Pasted image 20240326205011.png]]
![[support/img/Pasted image 20240326210104.png]]