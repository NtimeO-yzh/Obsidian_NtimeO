# 第一章 光学基础
## 1.1 波粒二象性
波粒二象性说的一定是粒子. 说一个粒子不仅有粒子性, 还有波动性. 而光波是大量的光子组成的, 其分布体现了微观的粒子波动性. 因此上来就有一个光波的公式.
- 光的轨道角动量是与偏振相关联的。涡旋光轨道角动量是大量(近似)同态光子(如激光)偏振状态的反映，单个光子也有波动性，也有偏振态，因此单个光子也有轨道角动量。
- 光子波动性的宏观统计规律就是反映在电磁场的时空周期性上, 因此使用电磁场来描述光.
- *定态光波*要求, 矢量场每一点的振幅不随时间变化.(还有每一点同频简谐震荡).
- 同性介质中满足傍轴条件时, 标量波(矢量的分量值)代替矢量波是ok的.
## 1.2 光波的数学描述
球面波、平面波都是波动方程的基本解。由波动方程的线性性质，任何复杂的波都能用球面波或平面波的线性组合表示。因此有必要讨论这些波如何从数学上来描述。在此之前，我们首先要介绍复振幅这一重要物理量的概念。
### 1.2.1 单色光场的复振幅表示
单色光波长中(**==为什么要强调单色光波场==**), 某点$P$在$t$时刻的光振动$u(P,t)$的表达式为(**==咋推出来的==**)($a(P)$表示振幅, 只和空间有关,说明是定态光波)
$$u(P,t)=a(P)\cos[2\pi\nu t-\varphi(P)]\tag{1}$$
根据欧拉公式, **一个余弦函数可以表示为对应的复指数函数的实部**.(注意是**表示**, **不是等于**一个复指数数函数), 因此上式对应的复指数函数的实部为$$\begin{aligned}
u(P,t)& =\mathrm{Re}\left\{a\left(P\right)\mathrm{e}^{-\mathrm{j}\left[2\pi\nu t-\varphi\left(P\right)\right]}\right\}  \\
&=\mathrm{Re}\{ a(P)\mathrm{e}^{\mathrm{j}\varphi(P)}\mathrm{e}^{-\mathrm{j}2\pi\nu t}\} 
\end{aligned}\tag{2}$$
- 好处: 把位相中由空间变量的部分$\varphi (P)$和时间变量分$2\pi\nu t$开来
定义*复振幅*: 式$(2)$中花括号内和空间有关的部分拿出来, 则有$$U(P)=a(P)\mathrm{e}^{\mathrm{j}\varphi(P)}\tag{3}$$
这样$U(P)$就是单色光波场$P$点的复振幅, 包含了振幅和初相位. ==对于单色光波来说, 频率单值且恒定, 因此式$(2)$中的时间变量$\mathrm{e}^{-\mathrm{j}2\pi\nu t}$在任一时刻就是一个常数, 对于光场空间各点来说是不变的.利用复振幅$U$==, 光振动可以表达为 $$u(P,t)=\mathrm{Re}\left\{U(P)\mathrm{e}^{-\mathrm{j}2\pi\nu t}\right\}\tag{4}$$
8在单色光波的线性运算（加、减、积分和微分等）中，可直接利用复振幅计算，导出所需结果的复振幅。例如，N 个同频率单色光波叠加，叠加后光场的复振幅直接等于N个光波复振幅之和。
计算光强也很简单, 如下
$$I=\mid U\mid^2=UU^*\tag{5}$$
### 1.2.2球面波
从点光源发出的光，其波面表现为球面波。我们常把一个复杂的光源看作是许多点光源的集合，**所以点光源是一个重要的基本光源**，球面波是基本的波面形式。单色的**发散**球面波在光场中任意一点P所产生的复振幅为$$U(P)=\frac{a_0}r\mathrm{e}^{\mathrm{j}kr}\tag{6}$$
其中, 
- $k=\frac{2\pi}{\lambda}$, *波数*, 表示单位长度上的相位变化($\lambda对应2\pi$, 因此除一下就是单位长度上的相位变化)
- $r$观察点$P(x,y,z)$离开点光源的距离
- $a_{0}$表示距点光源**单位距离处**的振幅
对于汇聚球面波, 则有$$U(P)=\frac{a_0}r\mathrm{e}^{-\mathrm{j}kr}\quad.\tag{7}$$
当光源的汇聚点为坐标原点的时候, 有$$r=(x^{2}+y^{2}+z^{2})^{1/2}\tag{8}$$
当光源汇聚于空间任意一点的时候,有$$r=\left[\left(x-x_0\right)^2+\left(y-y_0\right)^2+\left(z-z_0\right)^2\right]^{1/2}\tag{9}$$
#### (a)特定平面上的复振幅
在许多光学问题中，所关心的往往是某个选定平面上的光场分布。例如衍射场中的孔径平面、观察平面，成像系统中的物平面和像平面等。因而有必要讨论光波在某一特定平面上产生的复振幅分布的数学描述。如图3-1所示，点光源$S(x_{0},y_{0}, 0)$位于$z=0的x_{0}y_{0}$平面, 考查与其相距为$z\quad(z>0)$的$xy$平面上的光场分布. ![[support/img/Pasted image 20240605120522.png|316]]
- 在这一平面上,$r$**满足**下式$$r=\left[z^{2}+\left(x-x_{0}\right)^{2}+\left(y-y_{0}\right)^{2}\right]^{1/2}=z\Big[1+\frac{\left(x-x_{0}\right)^{2}+\left(y-y_{0}\right)^{2}}{z^{2}}\Big]^{1/2}\tag{10}$$
- **当$xy$平面上只考虑一个张角不大的范围时**, 此时有
#limit ==[傍轴近似]==
$$\frac{\left(x-x_0\right)^2+\left(y-y_0\right)^2}{z^2}<<1\tag{11}$$
- 二次展开, 忽略高阶项$$r\approx z+\frac{\left(x-x_0\right)^2+\left(y-y_0\right)^2}{2z}\tag{12}$$
- 把式$(12)$代入式$(7)$, **物理含义就是这个平面上的复振幅分布**$$U(x,y)=\frac{a_{0}}{z+\frac{\left(x-x_0\right)^2+\left(y-y_0\right)^2}{2z}}\mathrm{exp}(\mathrm{j}kz)\mathrm{exp}\Big\{\mathrm{j}\frac{k}{2z}\Big[(x-x_{0})^{2}+(y-y_{0})^{2}\Big]\Big\}\tag{13}$$
- 上式$(13)$中的$r$已经使用了$r$的近似了, 但是会发现振幅项由于考察的区域$z$的相对变化很小, 因此第一项振幅上的分母可以直接当做$z$. 但是后边的两个相位项不可以, 因为后边的$\frac{\left(x-x_0\right)^2+\left(y-y_0\right)^2}{2z}$多乘了一刻$k=\frac{2\pi}{\lambda}$, 由于波长$\lambda$很小啊, 所以这个波数$k$很大, 因此二次项不能忽略(**==那为啥三次项可以忽略==**), 因此上式变为$$U(x,y)=\frac{a_{0}}{z}\mathrm{exp}(\mathrm{j}kz)\mathrm{exp}\Big[\mathrm{j}\frac{k}{2z}\Big[(x-x_{0})^{2}+(y-y_{0})^{2}\Big]\Big\}\tag{14}$$
	#limit ==[傍轴近似]==
	其中相位因子有俩
	1. $exp(jkz)$是个常数
	2. $\mathrm{exp}{\left[\mathrm{j}\frac k{2z}{\left[(x-x_0)^2+(y-y_0)^2\right]}\right]}$称为*球面波的(二次)相位因子*, 表达了$x,y$变化的时候, 相位会发生变化.
	此外, 位相因子。当平面上复振幅分布的表达式中包含有这一因子时，就可近似认为距离该平面$z$ 处有一个点光源发出的球面波经过这个平面。从球面波的相位因子来看, 若符合$$\left(x-x_{0}\right)^{2}+\left(y-y_{0}\right)^{2}=C\tag{20}$$则表示了$xy$平面上的等相位线, 是一系列以$(x_{0},y_{0})$为圆心的同心圆.
	> 球形波面与xy 平面的交线。注意位相值相隔2$\pi$的同心圆之间的间隔并不相等， 而是由中心向外越来越密集。
- 当**光源在$(0,0)$的时候**, 发散球面波复振幅为$$U(x,y)=\frac{a_{0}}{z}\mathrm{exp}(\mathrm{j}kz)\exp\Bigl[\mathrm{j}\frac{k}{2z}(x^{2}+y^{2})\Bigr]\tag{21}$$汇聚平面波复振幅为$$U(x,y)=\frac{a_0}{z}\mathrm{exp}(-\mathrm{j}kz)\exp\Big[-\mathrm{j}\frac{k}{2z}(x^2+y^2)\Big]\tag{22}$$
![[support/img/Pasted image 20240605123433.png|362]]
超前: 早发出的, 相对于考查波前就是超前
滞后: 比我晚发出的

### 1.2.3平面波
平面波的来源:
- 点光源经过透镜准直
- 把点光源移到无穷远处
沿着波矢$k$方向传播的单色平面波, 在光场$P(x,y,z)$点产生的复振幅可以表示为
$$U(x,y,z)=a\mathrm{exp}[\mathrm{j}k(x\mathrm{cos}\alpha+y\mathrm{cos}\beta+z\mathrm{cos}\gamma)]{\tag{23}}$$
其中, 
- $a$表示常量振幅
> [!Note] 常量振幅
> 如何理解振幅是常量?为什么不和球面波一样是一个随着距离衰减的数?
> 可以从能量的角度来解释, 每一时刻, 点光源发出的能量是一定的, 但是, 越靠近点光源的地方, 能量分布的面积密度就越大, 所以就体现在振幅之上, 但是一旦是理想的平面波之后, 每一个面的大小都是一样的, 所以说, 振幅都是一样的. 但是从这个角度来想无穷远的点光源的振幅, 还应该遵守那个式子啊, 就有点想不懂了.
> 
- $\mathrm{cos}\alpha、\mathrm{cos}\beta、\mathrm{cos}\gamma$为传播方向的余弦, 其满足$\cos^2\alpha+\cos^2\beta+\cos^2\gamma=1$![[support/img/Pasted image 20240605142838.png|201]]
把$z$单独拿出来, 上式可以写作$$\begin{aligned}U(x,y,z)&=a\exp(\mathrm{j}kz\mathrm{cos}\gamma)\exp[\mathrm{j}k(x\mathrm{cos}\alpha+y\mathrm{cos}\beta)]\\&=a\exp(\mathrm{j}kz\sqrt{1-\cos^{2}\alpha-\cos^{2}\beta)}\exp[\mathrm{j}k(x\mathrm{cos}\alpha+y\mathrm{cos}\beta)]\end{aligned}\tag{24}$$
平面波的方向确定了, 则几个余弦值也确定了, 接下来如果所考察平面的$z$轴方向的距离也确定了, 那么, 第一个相位因子就是一个定值. 这样可以定义$A$如下$$A=a\exp(\mathrm{j}kz\sqrt{1-\cos^{2}\alpha-\cos^{2}\beta})\tag{25}$$
其表示了在一个xy平面上, 随着$z和传播方向k$而变化的常数值.将$(25)$带入$(24)$得到$$U(x,y)=A\exp[\mathrm{j}k(x\mathrm{cos}\alpha+y\mathrm{cos}\beta)]\tag{26}$$
称$\exp[\mathrm{j}k(x\mathrm{cos}\alpha+y\mathrm{cos}\beta)]$为*平面波的相位因子*. 若表达式包含这一项, 也可以确定是一个平面波经过了该$xy$平面引起了电磁场分布.
等相位线是一簇直线, 符合$$xcos\alpha+ycos\beta=C\tag{27}$$
具体参考上面的图3-3. 每条线标注出来的是相差$2\pi$的, 这两条线上的点振动情况是一样的.这体现了空间的周期性.
### 1.2.4平面波的空间频率
考虑在$xz$平面内的传播, 则有$cos\beta=0$, 因此$xy$平面上的复振幅可以表示为$$U(x,y)=A\exp(\mathrm{j}kx\mathrm{cos}\alpha)\tag{28}$$
这样, 观察上式, 等相位线满足$$xcos\alpha=C\tag{29}$$
意思是, 在$xy$平面上的满足这一条件的直线是**相位一模一样的**.但是, 由于e指数有周期性, 所以每隔$2\pi$, 两个线的振动情况是一样的, 因此相位周期在空间上的体现就是空间周期.每两个等相位线的间隔满足$$kX\mathrm{cos}\alpha=2\pi \tag{29}$$

因此, 得到*空间周期*$X$满足$$X=\frac{2\pi}{k\mathrm{cos}\alpha}=\frac{\lambda}{\mathrm{cos}\alpha}\tag{30}$$
空间周期的倒数就是*空间频率*, 表示$x$防线上单位长度内变化的周期数, 记为$$f_{x}=\frac{1}{X}=\frac{\mathrm{cos}\alpha}{\lambda}\tag{31}$$
单位为$周/mm$
等相位线是在$xy$平面上的一簇平行线, 平行于$y轴$, 因此[GPT4All](https://gpt4all.io/index.html)$$f_{y}=\frac{1}{Y}=0\tag{32}$$
这样一来，传播方向余弦为(cos$\alpha,0)$的单色平面波在$xy$平面上复振幅的
周期分布就可用$x$、$y$方向的空间频率$\left(f_x=\frac{\cos\alpha}\lambda,f_y=0\right)$来描述。因此行式$(28)$可以改写为$$U(x,y)=A\exp(\mathrm{j}2\pi f_{x}x)\tag{33}$$
以后根据上式, 直接就能看出这是一个单色平面波, 传播方向$k$的方向余弦为cos$\alpha=\lambda f_{z_1},\cos\beta=0$
注意, 空间频率可以为**负值, 但是只表示传播的方向**![[support/img/Pasted image 20240605163151.png|408]]
其实是只可以看出间隔的, 因为平行线之间的距离就是$\lambda$, 之后除以余弦值就是斜边.
因此一般情况下, $$f_{x}=\frac{1}{X}=\frac{\cos\alpha}{\lambda}\tag{34}$$$$f_{y}=\frac{1}{Y}=\frac{\cos\beta}{\lambda}\tag{35}$$
这样把以上两式代入$(26)$得到$$U(x,y)=A\exp[\mathrm{j}2\pi(f_{x}x+f_{y}y)]\tag{36}$$
这表示的是一般的传播方向在$xy$平面上的复振幅分布. 因此, 更一般的情况表示为$$f_z=\frac{\cos\gamma}\lambda \tag{37}$$$$U(x,y,z)=a\exp[j2\pi(f_{x}x+f_{y}y+f_{z}z)]\tag
{38}$$
并且三个方向上的空间频率满足$$f_{x}^{2}+f_{y}^{2}+f_{x}^{2}=\frac{1}{\lambda^{2}}=f^{2}\tag{39}$$
最后必须指出，空间频率的概念同样可以描述其他物理量的空间周期分布。但应当严格区别它们截然不同的物理含义。==例如、对于非相干照明的平面上的光强分布，也可以通过傅里叶分析利用空间频率来描述。但空间频率($f_x,f_y)$ 不再和单色平面波有关，$\exp[$ j2$\pi(f_xx+f_yy)]$也就不再对应沿某一方向传播的平面波。==
### 1.2.5 局部空间频率
### 1.2.6角谱(空间频谱)
对复振幅$U(x,y)$进行傅里叶分解得到
$$U(x,y)=\iint\limits_{-\infty}^{\infty}A(f_{x},f_{y})\exp[j2\pi(f_{x}x+f_{y}y)]\mathrm{d}f_{x}\mathrm{d}f_{y}\tag{40}$$
和式$(26)$进行比对, 发现上式就是不同的空间频率的平面波, 以权重$A(f_{x},f_{y})$的线性组合, 其中$A(f_{x},f_{y})$满足逆变换$$A(f_x,f_y)=\iint\limits_{-\infty}^{\infty}U(x,y)\exp\bigl[-\mathrm{j}2\pi(f_xx+f_yy\bigr]\mathrm{d}x\mathrm{d}y\tag{41}$$
由于空间频率对应了方向余弦, 因此可以把上式写为$$A\Big(\frac{\mathrm{cos}\alpha}{\lambda},\frac{\mathrm{cos}\beta}{\lambda}\Big)=\iint_{-\infty}^{\infty}U(x,y)\exp\Big[-\mathrm{j}2\pi\Big(\frac{\mathrm{cos}\alpha}{\lambda}x+\frac{\mathrm{cos}\beta}{\lambda}y\Big)\Big]\mathrm{d}x\mathrm{d}y\tag{42}$$
这时$A\left(\frac{\cos\alpha}\lambda,\frac{\cos\beta}\lambda\right)$就称作$xy$平面上复振幅分布的*角谱*。引入角谱的概念有助于进一步理解复振幅分解的物理含义：**单色光波场中某一平面上的场分布可看作不同方向传播的单色平面波的叠加，在叠加时各平面波成分有自己的振幅和常量位相，它们的值分别取决于角谱的模和辐角。**

## 1.3 标量衍射理论
### 1.3.1 历史引言
- 1687, 惠更斯原理: 如果把光扰动的波前上的每一点看成是一个“次级”球面扰动的新波源，那么随后任一时刻的波前可以由作出次级子波的“包络”而得到![[support/img/Pasted image 20240605212731.png|224]]
- 1804, 托马斯样引入干涉概念
- 1818, 菲涅尔对惠更斯原理做假设并引入次波相互干涉,能够精确算出衍射图样
- 1860, 麦克斯韦论证光为电磁波
- 1882, 基尔霍夫对惠更斯-菲涅尔表述做出数学假设和推导
- 1892~1894, 庞家来和索末菲证明基尔霍夫的两个假设相互矛盾
- 1896, 索末菲给出衍射问题的严格解
基尔霍夫理论和索末菲理论都把光作为标量处理了, 这个是影响最大的. 
==标量理论使用前提==
1. 衍射孔必须远大于波长
2. 不要再太靠近衍射孔的地方观察衍射场
### 1.3.2从矢量理论到标量理论
MKS单位制下, 无自由电荷存在时的Maxwell 方程组表示为$$\begin{aligned}
&\nabla\times\vec{\mathcal{E}}=-\mu\frac{\partial\vec{\mathcal{H}}}{\partial t}, \\
&\nabla\times\vec{\mathcal{H}}=\epsilon\frac{\partial\vec{\mathcal{E}}}{\partial t}, \\
&\nabla\cdot\epsilon\vec{\mathcal{E}}=0, \\
&\nabla\cdot\mu\vec{\mathcal{H}}=0,
\end{aligned}\tag{43}$$
==关键假设: 线性, 各向同性, 均匀介质,== 则有$$\nabla^2\vec{\mathcal{E}}-\frac{n^2}{c^2}\frac{\partial^2\vec{\mathcal{E}}}{\partial t^2}=0\tag{44}$$
由于标量方程也就是各矢量方程的分量, 因此分别单独满足$$\begin{aligned}\nabla^2u(P,t)-\frac{n^2}{c^2}\frac{\partial^2u(P,t)}{\partial t^2}=0\end{aligned}\tag{45}$$
如果不均匀, 则会不满足式$(44)$, 也就不会有标量衍射理论的正确了. 对一个在均匀介质中传播的波加上边界条件时，会发生相似的效应.**在边界上. 引进了$\vec{\varepsilon}$和$\vec{\mathcal{H}}$之间的耦合**，以及它们的各个标量分量之间的耦合.结果，即使传播介质是均匀的，使用标量理论也会带来某种程度的误差.这种误差只有当边界条件起作用的区域仅为光波通过区域的一小部分时，才会变得很小.在光波被孔径衍射的情况下$,\vec{\mathcal{E}}$ 场和 $\vec{\mathcal{H}}$ 场仅在孔径边缘被改变，光波与组成边缘的材料在那里发生相互作用. 这==个效应只延伸到孔径内几个波长的范围.因此若孔径的尺度比一个波长大得多，边界条件加在 $\vec{\varepsilon}$ 和 $\vec{r}$ 场上的耦合效应就会变得很小==. 我们将看到，这和孔径引起的衍射角很小的要求是等价的. 
#limit 
把$(4)$带入$(45)$, 并且只看复振幅$U(P)$, 则得到
> 和前面一样，$\nabla^2$是拉普拉斯算符，$n$是光在其中传播的介电介质的折射率，$c$是真空中的光速.由于与时间的函数关系已经预先知道，因此复函数$U(P)$已足以描述扰动.

$$(\nabla^2+k^2)U=0.\tag{46}$$
这个公式叫做, *亥姆霍兹方程*.
==在真空 $(n = 1)$ 或均匀电介质 $(n> 1)$ 中传播的任何单色光扰动的复振幅必定遵从 这一关系.==
#### (a)格林定理
*格林定理*: 令$U(P)$和$G(P)$为两个以位置为变量的任意复值函数，并令$S$为包围体积$V$的闭合曲面.如果$U$、$G$及它们的一阶和二阶偏导数都是单值的并且在$S$内和$S$上连续，则
$$\iiint_V(U\nabla^2G-G\nabla^2U)\mathrm{d}v=\iint_S\left(U\frac{\partial G}{\partial n}-G\frac{\partial U}{\partial n}\right)\mathrm{d}s\tag{49}$$
其中$\partial/\partial n$表示在$S$上每个点向外法线方向上的偏导数
这个定理在许多方面是标量衍射理论的主要基础但是,**只有慎重选择辅助函数 G 和闭合曲面 S, 才能将它直接用于衍射问题**.
- 现在的问题就变成, 选取函数$G$了
选取函数$G$为包以观察点$P_{0}$为中心向外发散的球面波, 对于任意一点$P_{1}$有$$G(P_1)=\frac{\exp(\text{j}kr_{01})}{r_{01}}\tag{48}$$
#### (b)格林函数
进一步讨论之前，我们先介绍一下格林函数.假设我们想要求解下面的非齐次线性微分方程：
$$a_2\frac{\mathrm{d}^2U}{\mathrm{d}x^2}+a_1\frac{\mathrm{d}U}{\mathrm{d}x}+a_0U=V(x)\tag{49}$$
其中$V(x)$是一驱动函数，而$U(x)$满足已知的一组边界条件. 我们选择一维变量$x$, 不过该理论很容易推广到多维的$\vec{x}.$可以证明 , 若$G(x)$是同一微分方程 (3-16)当$V(x)$**换成脉冲驱动函数**$\delta(x-x^\prime)$而保持边界条件不变时的解，则通解$U(x)$可以用特解$G(x)$的卷积积分表示
$$U(x)=\int G(x-x')V(x')\mathrm{d}x'\tag{50}$$
函数$G(x)$叫做这个问题的格林函数，显然它具有脉冲响应的形式. 
> 后面各节中要讨论的标量衍射问题的各种各样的解对应于对问题的格林函数作不同假设得出的结果.格林定理中出现的函数G，既可看成是我们为求解问题而选择的一个辅助函数，也可以最终将它和问题的脉冲响应函数联系起来.对格林函数理论的进一步讨论已超出本书的范围.

#### (c)积分曲面
现在我们回到讨论的中心议题. 要能够合法地用于格林定理中，函数$G$ (以及它的一阶和二阶偏导数) 必须在被包围的体积$V$内连续.因此，为了排除在$P_0$点的不连续性，我们用一个半径为$\epsilon$的小球面$S_\epsilon$将$P_0$点围起来.然后应用格林定理，积分体积$V^\prime$为介于$S$和$S_\epsilon$之间的体积，积分曲面是复合曲面
$$S'=S+S_\epsilon\tag{51}$$
![[support/img/Pasted image 20240605221111.png|224]]
如图 3.5 所示. 注意，复合曲面的“向外”的法线，在 $S$ 上如通常意义指向外侧，但在
$S_\epsilon$上则指向内侧 (指向$P_0).$
#### (d)求解
由于之前假设的辅助函数$G$也是满足亥姆霍兹方程的, 也就是有$$(\nabla^2+k^2)G=0\tag{52}$$
因此把$(46)$和$(52)$带入格林定理的左边, 得到$$\begin{aligned}\int\int\int_{V'}(U\nabla^2G-G\nabla^2U)\mathrm{d}v=-\int\int\int_{V'}(UGk^2-GUk^2)\mathrm{d}v\equiv0\end{aligned}\tag{53}$$
这样格林定理的右边也是0, 因此就有$$\begin{aligned}\iint_{S'}\left(U\frac{\partial G}{\partial n}-G\frac{\partial U}{\partial n}\right)\mathrm{d}s=0\end{aligned}\tag{54}$$或写为$$\begin{aligned}-\iint_{S_\epsilon}\left(U\frac{\partial G}{\partial n}-G\frac{\partial U}{\partial n}\right)\mathrm{d}s&=\iint_S\left(U\frac{\partial G}{\partial n}-G\frac{\partial U}{\partial n}\right)\mathrm{d}s\end{aligned}\tag{55}$$由式$(48)$得出其法线方向导数为$$\begin{aligned}\frac{\partial G(P_1)}{\partial n}=\cos(\vec{n},\vec{r}_{01})\left(\text{j}k-\frac{1}{r_{01}}\right)\frac{\exp(\text{j}kr_{01})}{r_{01}}\end{aligned}\tag{56}$$
其中$\cos(\vec{n},\vec{r}_{01})$代表向外的法线$\vec{n}$与从$P_0$到$P_1$的矢量$\vec{r}_01$之间夹角的余弦.对于$P_1$点在$S_\epsilon$上的特殊情形，$\cos(\vec{n},\vec{r}_01)=-1$, $(48)和(56)$变为$$G(P_1)=\frac{\mathrm{e}^{\mathrm{j}k\epsilon}}{\epsilon}\quad\text{和}\quad\frac{\partial G(P_1)}{\partial n}=\frac{\mathrm{e}^{\mathrm{j}k\epsilon}}{\epsilon}\left(\frac{1}{\epsilon}-\mathrm{j}k\right)\tag{57}$$令$\epsilon$任意变小, 由$U$及其导数在$P_{0}$点的连续性得到$$\begin{aligned}&\lim_{\epsilon\to0}\iint_{S_\epsilon}\left(U\frac{\partial G}{\partial n}-G\frac{\partial U}{\partial n}\right)\mathrm{d}s\\&=\lim_{\epsilon\to0}4\pi\epsilon^2\left[U(P_0)\frac{\exp(\text{j}k\epsilon)}{\epsilon}\left(\frac{1}{\epsilon}-\text{j}k\right)-\frac{\partial U(P_0)}{\partial n}\frac{\exp(\text{j}k\epsilon)}{\epsilon}\right]=4\pi U(P_0).\end{aligned}\tag{58}$$
把上式$(58)$带入$(55)$得到$$\begin{aligned}U(P_0)=\frac{1}{4\pi}\iint_S\left\{\frac{\partial U}{\partial n}\left[\frac{\exp(\text{j}kr_{01})}{r_{01}}\right]-U\frac{\partial}{\partial n}\left[\frac{\exp(\text{j}kr_{01})}{r_{01}}\right]\right\}\text{d}s\end{aligned}\tag{59}$$
这就是*亥姆霍兹和基尔霍夫的积分定理*.
其意义在于: ==使得任意一点的场可以用波在包围这一点的任意闭舍曲面上 的"边值"表示==

### 1.3.3基尔霍夫理论和平面屏幕衍射
问题描述: 现在我们考虑光在**无穷大不透明屏幕的孔**上的衍射.如图 3.6 所示，假定一个
波从左面入射到屏幕和孔上，要计算孔后一点$P_0$上的场，仍然假设场是单色的![[support/img/Pasted image 20240605232033.png|201]]
#### (a)使用亥姆霍兹-基尔霍夫积分定理
要算出$P_0$点的场，我们应用亥姆霍兹和基尔霍夫的积分定理，仔细选择一个积分曲面，使得计算能顺利完成.仿效基尔霍夫的做法，选择闭合面$S$由两部分组成，如图 3.6 所示. 令正好位于衍射屏幕后的平面$S_1$与一个半径为$R$、中心在观察点$P_0$的大球冠$S_2$连接起来构成闭合曲面.整个闭合曲面就是$S_1$与$S_2$之和.于是，应用$(56)$式，
$$U(P_0)=\frac1{4\pi}\iint_{S_1+S_2}\left(G\frac{\partial U}{\partial n}-U\frac{\partial G}{\partial n}\right)\mathrm{d}s
\tag{60}$$
和以前一样，其中的
$$G=\frac{\exp(\text{j}kr_{01})}{r_{01}}\tag{61}$$
随着$R$增大$,S_2$趋于一个大的半球壳. **人们也许会轻易推论，由于$U$和$G$都随着$1/R$减少，被积函数最终将消失，从而使$S_2$上的面积分之贡献为零.但是，由于积分面积按$R^2$增大，上述论据是不全面的. 人们也可能会轻易假设，既然扰动以有限速度$c/n$传播，$R$最终变得如此之大，使波来不及传到$S_2$,因此被积函数在这个面上将为零. 但是这个论据与我们作的单色扰动的假定不相容，按定义，单色扰动必须在所有时间都存在.显然，在我们能够妥善处理 $S_2$ 对积分的贡献之前，还需要作更细致的研究.** 如下:
在$S_2$上有$$\begin{aligned}&\\&G=\frac{\exp(\text{j}kR)}R\end{aligned}\tag{62}$$
带入上式进$(57)$得到$$\frac{\partial G}{\partial n}=\left(\text{j}k-\frac{1}{R}\right)\frac{\exp(\text{j}kR)}{R}\approx\text{j}kG\tag{63}$$
最后一个近似是在R很大的时候成立
#limit 
因此$(60)$中对于曲面$S_2$的积分变为$$\begin{aligned}\iint_{S_2}\left[G\frac{\partial U}{\partial n}-U(\text{j}kG)\right]\text{d}s=\int_{\Omega}G\left(\frac{\partial U}{\partial n}-\text{j}kU\right)R^2\text{d}\omega\end{aligned}\tag{64}$$
其中$\Omega$是$S_2$对$P_0$点张的立体角. 现在$|RG|$这个量在$S_2$上是一致有界的(带入$(62)$即可).只要扰动对角度一致地具有以下性质, $S_2$上的整个积分将随着$R$任意变大而消失
#limit 
$$\lim_{R\to\infty}R\left(\frac{\partial U}{\partial n}-\text{j}kU\right)=0\tag{65}$$
这意味着, 若扰动 U 趋于零的速度至少像发散球面波那样快(**==习题3-2==**). 它 **==保证了我们处理的只是在$S_2$面上出去的波而不是进来的波，==** 因为后者在 $S_2$上的积分当 $R\to\infty$ 时可能不为零.由于在我们的问题中，只有出去的波才会落到$S_2$上，在$S_2$上积分的贡献才会精确为零.
#### (b)基尔霍夫边界条件
在弃去曲面$S_2$上的积分后，现在能够把$P_0$点的扰动用紧贴在屏幕之后的无穷大平面$S_1$上的扰动及其法向微商表示，即
$$U(P_0)=\frac1{4\pi}\iint_{S_1}\left(\frac{\partial U}{\partial n}G-U\frac{\partial G}{\partial n}\right)\mathrm{d}s\tag{66}$$
除了张开的孔径 (用 Σ表示) 外，屏幕是不透明的. 所以，**直观上可以合理地认为**，对积分$(66)$的主要贡献来自$S_1$上的位于孔径 Σ内的那些点，我们预期被积函数在那里最大 . 因 此 ,基尔霍夫采用了以下的假定
(1)在孔径$\Sigma$上，场分布$U$及其导数$\partial U/\partial n$和没有屏幕时完全相同.
(2)在$S_1$的位于屏幕的几何阴影区内的那一部分上，场分布$U$及其导数$\partial U/\partial n$恒为零.
#limit 
这两个条件一般称为*基尔霍夫边界条件*. 第一个条件允许我们通过忽略屏幕的存在来确定射到孔径上的场扰动.第二个条件允许我们忽略全部积分曲面，除了直接位于孔径内的那一部分. 于是 $(66)$ 式简化为$$\begin{aligned}U(P_0)=\frac{1}{4\pi}\iint_{\Sigma}\left(\frac{\partial U}{\partial n}G-U\frac{\partial G}{\partial n}\right)\mathrm{d}s\end{aligned}\tag{67}$$虽然基尔霍夫边界条件使结果大为简化，但重要的是认识到，这两个条件中没有一个完全正确.屏幕的出现不可避免地将在某种程度上干扰$\Sigma$上的场，==因为沿着孔径边缘必须满足一定的边界条件，屏幕不存在时没有这些边界条件==.此外，屏幕后的阴影也不可能是理想的，因 **==为场必然会伸展到屏幕后几个波长的距离==** .但是如果孔径的尺寸比波长大很多，那么这些边缘效应尽可以放心地忽略.用这两个边界条件得出跟实验结果一致性非常好的结果.
#### (c)菲涅耳-基尔霍夫衍射公式
$U(P_0)$的表示式可以进一步简化. 注意到，从孔径到观察点的距离$r_{01}$通常比波长大得多，从而$k\gg1/r_01$,于是$(66)$式变成
#limit 
$$\begin{gathered}
\begin{aligned}\frac{\partial G(P_1)}{\partial n}\end{aligned} \begin{aligned}&=\cos(\vec{n},\vec{r}_{01})\left(\text{j}k-\frac{1}{r_{01}}\right)\frac{\exp(\text{j}kr_{01})}{r_{01}}\end{aligned} \\
\approx\text{j}k\cos(\vec{n},\vec{r}_{01})\frac{\exp(\text{j}kr_{01})}{r_{01}}
\end{gathered}\tag{68}$$
将$(68)和(61)$带入$(67)$得到
$$\begin{aligned}U(P_0)=\frac{1}{4\pi}\iint_{\Sigma}\frac{\exp(\text{j}kr_{01})}{r_{01}}\left[\frac{\partial U}{\partial n}-\text{j}kU\cos(\vec{n},\vec{r}_{01})\right]\text{d}s\end{aligned}\tag{69}$$
接下来就是要确定孔径平面处的复振幅分布, 也就是上式右边的$U$, 假设孔径上的$P_{1}$由点光源$P_{2}$发出的单个球面波照明, 图示和公式为![[support/img/Pasted image 20240605235906.png|224]]
$$\begin{aligned}U(P_1)=\frac{A\exp(\text{j}kr_{21})}{r_{21}}\end{aligned}\tag{70}$$
如果$r_{21}$有许多个波长那么长, 则上式$(70)$可以化简为(**==习题3-3==**)
#limit
$$\begin{aligned}U(P_0)=\frac{A}{\text{j}\lambda}\iint_{\Sigma}\frac{\exp[\text{j}k(r_{21}+r_{01})]}{r_{21}r_{01}}\left[\frac{\cos(\vec{n},\vec{r}_{01})-\cos(\vec{n},\vec{r}_{21})}{2}\right]\text{d}s\end{aligned}\tag{71}$$
这个结果只在由一个发散的球面波照明时成立,它叫做*菲涅耳-基尔霍夫衍射公式*
#### (d)进一步讨论
注意$(71)$式关于照明的点光源$P_2$和观察点$P_0$是对称的.因此$P_0$处的一个点光源在$P_2$产生的效果和$P_2$处一个同样强度的点光源在$P_0$点产生的效果相同. 这一结果叫做*亥姆霍兹倒易定理*.

最后，我们指出衍射公式 $(71)$的一个有趣的解释，以后我们还将回过头来对它详细讨论.把这个式子改写成如下形式：
$$U(P_0)=\iint_\Sigma\tilde{U}(P_1)\frac{\exp(\text{j}kr_{01})}{r_{01}}\mathrm{d}s\tag{72}$$其中
$$\tilde{U}(P_1)=\frac1{\text{j}\lambda}\left[\frac{A\exp(\text{j}kr_{21})}{r_{21}}\right]\left[\frac{\cos(\vec{n},\vec{r}_{01})-\cos(\vec{n},\vec{r}_{21})}2\right]\tag{73}$$于是$(72)$式可以解释为：$P_0$的场是由位于孔径内的无穷多个虚拟的“次级”点源产生的. 次级波源具有确定的振幅和相位，表示为$\tilde{U}(P_1)$,它与照明波前及照明方向和观察方向之间的角度有关。菲涅耳在融合惠更斯句络作图法和杨氏干涉原理的工作中，相当任意地作了类似上述解释的假设.**菲涅耳假定这些性质成立，以得到精确的结果.基尔霍夫证明，这些性质是光的波动本性的自然结果.** 注意，==上述推导限于孔径是由单个扩展球面波照明的情形.不过,下面我们将看到，在瑞利-索末菲理论中可以取消这一限制.==
### 1.3.4瑞利-索末菲衍射理论
实验发现，基尔霍夫理论会给出非常准确的结果，因而这一理论在实际问题中得到了广泛应用.但是，在这个理论中存在着一些内在矛盾，促使人们去寻求更满意的数学理论. 
基尔霍夫理论的困难在于**同时对场强及其法向导数二者施加边界条件**.
特别是，势论中有一个熟知的定理说，==如果一个二维势函数及其法向导数沿任一有限的曲线段同时为零，那么这个势函数必定在整个平面上为零，相仿地，如果三维波动方程的一个解在一有限的面元上为零，那么它必定在全空间为零.因而两个基尔霍夫边界条件合在一起就意味着，孔径后面各处的场恒等于零==，这一结果与已知的物理情况矛盾.
这种不自洽性的进一步表现是，==当观察点趋近屏幕或孔径时，可以证明菲涅耳-基尔霍夫衍射公式不能重新给出原来假定的边界条件.
尽管有这些矛盾，基尔霍夫理论仍然给出如此准确的结论，这的确是惊人的==.
索末菲消除了同时对扰动及其法向导数施加边界条件的必要性，从而克服了基尔霍夫理论的不自治性.
#### (a)格林函数的另一种选择
从假设基尔霍夫边界条件的上一个式子开始重新考虑,也就是从$(66)$, 重写一次并指明成立的条件$$\begin{aligned}U(P_0)=\frac{1}{4\pi}\iint_{S_1}\left(\frac{\partial U}{\partial n}G-U\frac{\partial G}{\partial n}\right)\mathrm{d}s\end{aligned}$$
成立的条件
1. 标量理论成立
2. U和G都满足其次标量波动方程
3. 满足索末菲辐射条件
假设我们把基尔霍夫理论中的格林函数加以改变，使之仍可得出上式，此外还使$G$ 或者$\partial G/\partial n$在整个$S_1$面上为零. 不论是哪种情况，都不必同时对$U$和$\partial U/\partial n$施加边界条件了，因而基尔霍夫理论的不自洽性也就消除了.
**索末菲指出，确实存在具有要求的这些性质的格林函数**. 设$G$不仅仅由位于$P_0$的点源产生，而且同时还由位于屏幕对面$P_0$的镜像点$\tilde{P}_0$上的第二个点源产生(见图 3.8). ![[support/img/Pasted image 20240606012058.png|316]]
#### (a)第一种解
令$\tilde{P}_0$处的点源与$P_0$的点源的波长同为$\lambda$,并且假设**两个源的振动有$180^\circ$的相位差(所以有个负号)**，这时格林函数由下式给出：
$$G_-(P_1)=\frac{\exp(\text{j}kr_{01})}{r_{01}}-\frac{\exp(\text{j}k\tilde{r}_{01})}{\tilde{r}_{01}}\tag{74}$$
显然这个函数$G_{_{-}}$在平面孔径$\Sigma$上为零，==并且基尔霍夫边界条件可以只加给$U$(就是积分区域从$S_{1}变为透光孔径)$==,因此代入$(66)$可以得到
$$U_1(P_0)=-\frac1{4\pi}\iint_\Sigma U\frac{\partial G_-}{\partial n}\mathrm{d}s\tag{75}$$
我们称这个解为第一种瑞利-索末菲解.接下来, 进一步确定这个解. 令$\tilde{r}_{01}$为从$\tilde{P}_0$到$P_1$的距离.对应的$G_-$的法向导数是
$$\begin{aligned}\frac{\partial G_-}{\partial n}(P_1)&=\cos(\vec{n},\vec{r}_{01})\left(\mathrm{j}k-\frac{1}{r_{01}}\right)\frac{\exp(\mathrm{j}kr_{01})}{r_{01}}\\&-\cos(\vec{n},\vec{r}_{01})\left(\mathrm{j}k-\frac{1}{\tilde{r}_{01}}\right)\frac{\exp(\mathrm{j}k\tilde{r}_{01})}{\tilde{r}_{01}}.\end{aligned}\tag{76}$$
对于$S_{1}$上的$P_{1}$点有
$$\begin{aligned}r_{01}&=\tilde{r}_{01},\\\cos(\vec{n},\vec{r}_{01})&=-\cos(\vec{n},\vec{\tilde{r}}_{01})\end{aligned}\tag{77}$$
因此在该平面上有$$\frac{\partial G_-(P_1)}{\partial n}=2\cos(\vec n,\vec r_{01})\left(\text{j}k-\frac1{r_{01}}\right)\frac{\exp(\text{j}kr_{01})}{r_{01}}\tag{78}$$**==假定$U(P_1)$在屏幕的阴影中消失，在敞开的孔径$\Sigma$中不受干扰(为啥可以这么假定, 在公式中也没体现啊)==**，由此得到$P_0$处场的第一种瑞利-索末菲解为
#limit 
$$U_{\mathrm{I}}(P_0)=-\frac1{2\pi}\iint_{\Sigma}U(P_1)\left(\text{j}k-\frac1{r_{01}}\right)\frac{\exp(\text{j}kr_{01})}{r_{01}}\cos(\vec{n},\vec{r}_{01})\mathrm{d}s\tag{79}$$
**==它可以写成一个卷积==**
$$U_\text{ I }(x,y,z)=h(x,y,z)*U(x,y,0)\tag{80}$$
其中, 
- $h(x,y,z)\text{ 是这个解的脉冲响应}$$$\begin{aligned}h(x,y,z)=\frac{1}{2\pi}\frac{z}{r}\left(\frac{1}{r}-\text{j}k\right)\frac{\exp(\text{j}kr)}{r}\end{aligned}\tag{81}$$
- $\cos(\vec{n},\vec{r}_{01})=z/r$
- $r=\sqrt{x^2+y^2+z^2}$
这是第一种索末菲解的完整表达式.
还有一个特点是注意格林函数$G_-$的法向导数简单地是基尔霍夫解中所用的格林函数$G$的法向导数的两倍，即
$$\frac{\partial G_-(P_1)}{\partial n}=2\frac{\partial G(P_1)}{\partial n}\tag{82}$$
#### (b)第二种解
通过允许两个点源同相振动，可求得另一个同样成立的格林函数为
$$G_+(P_1)=\frac{\exp(\text{j}kr_{01})}{r_{01}}+\frac{\exp(\text{j}k\tilde{r}_{01})}{\tilde{r}_{01}}\tag{83}$$
容易证明 (见习题 3-4), 这个函数的法向导数在屏幕和孔径上为零，得出第二种瑞利一索末菲解为
$$U_\text{ II }(P_0)=\frac1{4\pi}\iint_{S_1}\frac{\partial U(P_1)}{\partial n}G_+(P_1)\mathrm{d}s\tag{84}$$
可以证明，在$\Sigma$上$,G_+$是基尔霍夫的格林函数$G$的两倍
$$G_+=2G\tag{85}$$
因此把$(61)$的二倍带入$(84)$得到$$\begin{aligned}U_{\text{ II }}(P_0)=\frac{1}{2\pi}\iint_{\Sigma}\frac{\partial U(P_1)}{\partial n}\frac{\exp(\text{j}kr_{01})}{r_{01}}\text{d}s\end{aligned}\tag{86}$$
 此式在$U(P_1)$的**法向导数在孔径$S$外为零**的假定下成立.==一般而言，第一种索末菲解是最容易应用的，因为它取决于$U$而不是$\partial U/\partial n.$
 == #limit

#### (c)瑞利-索末菲衍射公式
 对于第一种索末菲解,即$(79)$来说, 在满足条件$r_{01}\gg\lambda$ , $(79)$可以化简为(**==为啥是$S_1$==**)
 #limit 
 $$\begin{aligned}U_\text{ l }(P_0)=\frac{1}{\text{j}\lambda}\iint_{S_1}U(P_1)\frac{\exp(\text{j}kr_{01})}{r_{01}}\cos(\vec{n},\vec{r}_{01})\text{d}s\end{aligned}\tag{87}$$
  现在可以将基尔霍夫边界条件只应用于 U, 得到一般结果$$\begin{aligned}U_\text{ l }(P_0)=\frac{1}{\text{j}\lambda}\iint_\Sigma U(P_1)\frac{\exp(\text{j}kr_{01})}{r_{01}}\cos(\vec{n},\vec{r}_{01})\text{d}s\end{aligned}\tag{88}$$
  ==由于不需要对$\partial U/\partial n$施加边界条件,基尔霍夫理论的不自治性消除了.== 

**由于基尔霍夫理论只能用在"用一个发散球面波照明"的情况下**, 因此要对索末菲公式进行特殊化.上述的情况对应$$U(P_1)=A\frac{\exp(\text{j}kr_{21})}{r_{21}}\tag{89}$$
带入$(88)$则有$$\begin{aligned}U_{\text{ l }}(P_0)=\frac{A}{\text{j}\lambda}\iint_{\Sigma}\frac{\exp[\text{j}k(r_{21}+r_{01})]}{r_{21}r_{01}}\cos(\vec{n},\vec{r}_{01})\text{d}s\end{aligned}\tag{89}$$
这个公式称为*瑞利-索末菲衍射公式*.
由于$(88)$是$G_{_{-}}$得到的, 因此, 还有一个使用$G_{+}$的结果为$$U_{\textrm{II}}\left(P_{0}\right)=-\frac{A}{\textrm{j}\lambda}\iint_{\Sigma}\frac{\operatorname{exp}[\operatorname{j}k(r_{21}+r_{01})]}{r_{21}r_{01}}\operatorname{cos}(\vec{n},\vec{r}_{21})\mathrm{d}s\tag{90}$$
上式也默认了$r_{01}\gg\lambda$ , $\color{green}并且n和r_{21}的夹角大于90^o$
#### (d)边界条件复现
最常见的情形是，衍射公式表述的条件是 $r_{01}>λ$，这个近似在绝大多数实际应用中得到满足.(意思就是说, $r_{01}>\lambda$是衍射中的常见情形).这导致的通常的结果是把$(81)$式中的$\frac{1}{r_{01}}$直接忽略了, 就像我们对$(68)$式中所做的那样.
现在的问题是, 索末菲所要求的完备解是需要有严格的脉冲响应公式$(81)$, 这个脉冲响应应该满足边界条件, 如果做了近似还满足吗? 
对${81}$做以下变换$$h(x,y,z)=\frac{1}{2\pi}\frac{z}{r}\left(\frac{1}{r}-\mathrm{j}k\right)\frac{\exp(\mathrm{j}kr)}{r}=h_1(x,y,z)+h_2(x,y,z)\tag{91}$$
其中,
-  $$r=\sqrt{x^2+y^2+z^2}\tag{92}$$
-  $$\begin{aligned}h_1(x,y,z)=\frac{z}{\text{j}\lambda}\frac{\exp(\text{j}kr)}{r^2}\end{aligned}\tag{93}$$
-  $$h_2(x,y,z)=\frac{z}{2\pi}\frac{\exp(\text{j}kr)}{r^3}\tag{94}$$
==**用Mathematic软件**==可以证明, 当$z→0$的时候, $h_1$下面的体积→0, $h_{2}$下面的体积为1, 因此$h$下面的体积为1, 且在$\rho =0的时候$$h_2$的值趋于$\infty$,且在$\rho \neq0的时候$$h_2$的值趋于$0$, . 
也就是说, $h边界条件处(z→0)的正确性是由h_2保证的, 和h_1无关.$
> [!question] 边界条件
> 为啥是1就是正确的, 是不是次波源, 理解不太好, 但很重要,为什么必须是$\delta$函数

所以很矛盾的是, $h$和$h_2$都能复现边界条件，但$h_1$不能.但是，==由于几乎一切实==
==际应用涉及的距离都是$r\gg\lambda$,在下面大多数情形下都将作近似$h\approx h_1.$==

#### (f)基尔霍夫理论和瑞利一索末菲理论的比较
我们简短地总结一下基尔霍夫理论和瑞利-索末菲理论的相似之处和不同之处.为了本节的目的，用$G_K$表示基尔霍夫理论的格林函数，而$G_-$和$G_+$表示两种瑞利-索末菲表述中的格林函数.前已指出，在$\Sigma$面上，$G_+=2G_K$及$\partial G_-/\partial n=$ $2\partial G_K/\partial n.$因此我们感兴趣的普遍结果在下面给出.对于基尔霍夫理论,即对式$(67)$重写为
$$U(P_0)=\frac{1}{4\pi}\iint_{\Sigma}\left(\frac{\partial U}{\partial n}G_K-U\frac{\partial G_K}{\partial n}\right)\mathrm{d}s\tag{95}$$
对第一种瑞利-索末菲解,即式$(75)(82)$重写为
$$U_\text{ l }(P_0)=-\frac1{2\pi}\iint_\Sigma U\frac{\partial G_K}{\partial n}\mathrm{d}s\tag{96}$$
对第二种瑞利-索末菲解,即式$(85)(66)$
$$U_{\text{II}}\left(P_0\right)=\frac{1}{2\pi}\iint_{\Sigma}\frac{\partial U}{\partial n}G_K\mathrm{d}s\tag{97}$$
上面各个式子的比较使我们得到一个有趣并令人惊讶的结论：**基尔霍夫解是两个瑞利-索末菲解的算术平均！**
比较球面波照明与$r_{01}\gg\lambda$情形的三种方法的结果，我们看到，由瑞利-索末菲理论得出的结果 (即 $(89)$式和$(90)$式) 同菲涅耳-基尔霍夫理论衍射公式$(71)$的**不同仅在于所谓的倾斜因子**$\psi$,这个因子是余弦项引入的角度依赖关系.所有情况都可以写成
$$U(P_0)=\frac A{\mathrm{j}\lambda}\iint_\Sigma\frac{\exp[\mathrm{j}k(r_{21}+r_{01})]}{r_{21}r_{01}}\psi\mathrm{d}s\tag{98}$$
其中
$$\left.\psi=\left\{\begin{array}{ll}\dfrac{1}{2}[\cos(\vec{n},\vec{r}_{01})-\cos(\vec{n},\vec{r}_{21})]\quad\quad\quad基尔霍夫解\\\cos(\vec{n},\vec{r}_{01})\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad索末菲解一\\-\cos(\vec{n}\vec{r}_{21}),\quad\quad\quad\quad\quad\quad\quad\quad\quad索末菲解二\end{array}\right.\right.\tag{99}$$
对于无限远处的点光源产生的正入射平面波照明的特殊情况，倾斜因子变成$$\psi=\begin{cases}&\frac{1}{2}[1+\cos\theta],&\text{基尔霍夫理论,}\\&\cos\theta,&\text{第一种瑞利-索末菲理论,}\\&1,&\text{第二种瑞利-索末菲理论,}&&\end{cases}\tag{100}$$
其中，
- $\theta$是矢量$\vec{n}$和$\vec{r}_{01}$之间的夹角.
许多作者对衍射问题的两种公式化表述进行了比较. 我们特别要提到 Wolf 和 Marchand $^{[377]}$的工作，他们考察了圆形孔径、观察点距孔径足够远以至于可以看成“远场”(这个术语的意思将在下章解释)的情况下这两种理论的差别.他们发现。==只要孔径的直径比波长大得多，则基尔霍夫解与两种瑞利-索末菲解实质相同==. Heurtley$^{[168]}$考察了观察点在圆孔径的轴上、离孔径不同距离时这三个解的预言， 他发现只是在靠近孔径处才有差异.
当==衍射问题只涉及小角度时，容易证明这三个解是一样的. 当角度小时，三种情况下的倾斜因子都趋于 1,各个结果之间的差异就消失了==.注意，若我们离衍射孔径远，则讨论仅涉及小角度.
==在结束本节时，值得指出，尽管基尔霍夫理论具有内在的不自洽性，但在一种意义上说这个理论比瑞利-索末菲理论更普遍.后者要求衍射屏是平面的，而前者没有这一要求.不过，我们在这里感兴趣的绝大多数问题涉及的都是平面衍射孔径， 因而这一普遍性就不特别重要了.事实上，我们一
般将选用第一种瑞利-索末菲解. 因为它简单.==
#### (g)重新认识
使用第一种索菲末理论,也就是公式$(88)$, 可以看到, 这就是对惠更斯-菲涅尔原理(次波+相干)的$K(\theta)$的确定方法, 把该式子重新写为$$U(P_0)=\iint_{\Sigma}h(P_0,P_1)U(P_1)\mathrm{d}s\tag{101}$$
发现这个就是叠加积分, 脉冲响应为$$h(P_0,P_1)=\frac1{\mathrm{j}\lambda}\frac{\exp(\mathrm{j}kr_{01})}{r_{01}}\cos\theta\tag{102}$$
若更完整的描述是,$r_{01}不必\lambda$大很多, 则有$$h(P_0,P_1)=\frac1{2\pi}\left(\frac1{r_{01}}-\mathrm{j}k\right)\exp(\mathrm{j}kr_{01})\cos\theta\tag{103}$$
我们分析衍射的结果出现了一个叠加积分，这不应该使我们惊奇，前面已经看到得出这一结果所要求的主要因素是线性性质，**==而在我们的分析中曾假定这一性质存在(次波叠加对吧??)==**. 当我们在第 4 章更详细地考察脉冲响应$h(P_0,P_1)$的性质时，**==我们将会看到它也具有空间不变性(怎么证, 什么用)==**，这是我们假定电介质均匀的结果.这时还将看到惠更斯-菲涅耳原理是一个卷积积分(==现在还是叠加积分, 不是卷积积分)==。
# 第二章 二维线性系统
物理系统: 激励→响应.
变换: 输入→输出.
因此可以把成像系统看做一个变换.更具体来说, 可以看做实值函数: 随空间位置变化的光强函数; 也可以看做复值函数: 随空间变化的复振幅函数. 但都是二维的.
- 关心一输入一输出
- 关心边端性质: 只看输入输出, 不看内部结构
## 2.1 线性系统

### 2.1.1 数学算符表示系统
使用数学算符$\mathscr{L}\{\}$来描述系统的作用.使用 $f(x,y)$表示输入$g(x,y)$表示输出, 则有:
$$g(x,y)=\mathscr{L}|f(x,y)|$$
具体的确定算符$\mathscr{L}$是很难得, 取决于物理系统的本身性质.<u> 接下来要讨论线性性质</u>.
### 2.1.2线性系统的定义
考虑一个用算符 $\mathscr{L}$ 表示的系统，对任意两个输人函数$f_1(x,y)$ 和$f_2$$(x,y)$,有$$\begin{aligned}\mathscr{L}\{f_1(x,y)\mid=g_1(x,y)\\\mathscr{L}\{f_2(x,y)\mid=g_2(x,y)\end{aligned}$$
若对于任意复数常数$a_1,a_{2}$，当输人函数为时，输出函数为$a_1f_1(x,y)+a_2f_2(x,y)$时, 输出的函数为$$\begin{aligned}
\mathscr{L}\{a_{1}f_{1}(x,y)+a_{2}f_{2}(x,y)\}& =\mathscr{L}\{a_{1}f_{1}(x,y)\}+\mathscr{L}\{a_{2}f_{2}(x,y)\}  \\
& =a_1\mathscr{L}\{f_1(x,y)\}+a_2\mathscr{L}\{f_2(x,y)\}  \\
&=a_1g_1(x,y)+a_2g_2(x,y)
\end{aligned}$$
则说明此系统是线性系统.上式表明了: 线性系统具有叠加性质，**即系统对几个激励的线性组合的整体响应就等于各单个激励所产生的响应的线性组合**. 
这样的好处为: 可以方便地求出系统对于任意复杂输人的响应. **我们首先把复杂输入分解成许多更加基本的函数, 即"基元"函数的线性组合.而基元函数的响应是轻容易单独确定的**.这些基元函数的响应再经线性组合，就可以得到复杂输人月对应的输出。基元函数（或基元激励）通常是指不能再进行分解的基本函数单元。在线性系统分析中，常用的基元函数有$\delta$函数、阶跃函数、余弦函数、复指数函数等.
### 2.1.3脉冲响应
脉冲: $\delta$函数
脉冲分解: 函数$f(x,y)$看作是$xy$平面上许多$delta$函数以$f(\xi,\eta)$为权重的线性叠加.$$f(x,y)=\iint_{-\infty}^{\infty}f(\xi,\eta)\delta(x-\xi,y-\eta)\mathrm{d}\xi\mathrm{d}\eta $$系统的作用可用算符表示，于是相应的输出为$$\begin{aligned}g(x,y)&=\mathscr{L}\{f(x,y)\mid\\&=\mathscr{L}\{\iint_{-\infty}^{\infty}f(\xi,\eta)\delta(x-\xi,y-\eta)\mathrm{d}\xi\mathrm{d}\eta\}\end{aligned}$$
由于线性系统具有叠加性质(**==哪说是线性系统了==**), 因此==可以把算符$\mathscr{L}$弄到里边去==, 之后再叠加, 因此就有$$g(x,y)=\iint_{-\infty}^{\infty}f(\xi,\eta)\mathscr{L}\{\delta(x-\xi,y-\eta)\}\mathrm{d}\xi\mathrm{d}\eta $$
定义*脉冲响应*为: $$h(x,y;\xi,\eta)=\mathscr{L}\{\delta(x-\xi,y-\eta)\}$$
其表示系统输入点$(\xi,\eta)$对系统输出点$(x,y)$的影响, 或者说后者对于前者的响应.这样, 系统的输出可以写为$$g(x,y)=\iint_{-\infty}^{\infty}f(\xi,\eta)h(x,y;\xi,\eta)\mathrm{d}\xi\mathrm{d}\eta\tag{1} $$
该式子称为"叠加积分".
另一方面，==假若系统的输人函数$f(x,y)$和输出函数$g(x,y)$ 之间存在着叠加积分所描述的关系，就可以认为这是一个线性系统。==
对于光学系统的意义在于: 把输入的图像或者物体看做是点的集合, 经过脉冲响应, 确定了一系列的响应, 之后根据这些响应叠加起来即可.
> 必须强调指出，只有把所有点物的像叠加起来，才能得到输出图像。即完全确定一个线性系统的性质，需要知道系统对于输人平面所有可能位置上的$\delta$函数输入的脉冲响应(**==感觉不难啊==**)。显然，要做到这一点， 仍然是困难的。只<u>是对于线性系统的一个重要子类—线性不变系统，分析才变得十分简单。</u>
## 2.2线性不变系统
### 2.2.1线性不变系统的定义
一个线性系统的性质可能是随时间(或空间位置)变化的。例如，一个电路系统，不同时刻$\tau$输入的时间脉冲信号，其响应$h$ 的波形可能并不相同。其函数形式与输入时刻$\tau$有关，记为$h(t,\tau)$
$$\mathscr{L}\{\delta(t-\tau)\}=h(t-\tau)$$
- 例子: 比如有电容的电路, 电压输入输出之间不一样
若输入脉冲延迟时间$\tau$，其响应$h$仅仅有相应的时间延迟$\tau$，而函数形式不变，即$$\mathscr{L}\{\delta(t-\tau)\}=h(t-\tau)$$
我们称这样的线性系统是*时不变系统*。**这种系统输人与输出之间的变换关系是确定的，不随时间变化。固定电阻、电容、电感的特性在一段时间内，可看作是不随时间变化的，由它们组成的电路是时不变的。**
一个空间脉冲在输入平面位移，线性系统的响应函数形式不变，**只是产生相应位移**，即(定义这是)$$\mathscr{L}\{\delta(x-\xi,y-\eta)\}=h(x-\xi,y-\eta)$$
这样的系统称为*空间不变系统或位移不变系统*。对于空间不变的线性系统，其脉冲响应(因为就是上式)
$$h(x,y;\xi,\eta)=h(x-\xi,y-\eta)\tag{2}$$
因此针对于任意指定的一对输入输出, $h$的值只取决于输入输出的相对距离, 也就是说:**其输入输出的变换关系是不随空间的位置而变化的.**

---

- 例子
![[support/img/Pasted image 20240604132313.png]]
以上过程对应的式子就是$$\mathscr{L}\{f(x,y)\mid=g(x,y)$$
变为了平移之后的$$\mathscr{L}\{f(x-\xi,y-\eta)\}=g(x-\xi,y-\eta)$$
==从这个式子看, 脉冲响应就是$\delta$函数作为输入时的输出.==
对于光学系统的意义来说就是: 当点光源在物平面移动时，点光源的像只相应改变位置，而不改变它的函数形式，这样的成像系统就是空间不变的。
- ==不严谨的点:== 如，实际成像系统虽然在整个物面上不可能是等晕的，但可以把物面划分成许多小的等晕区，在每一个小的等晕区内，认为系统是空间不变的。完备地描述成像系统，必须对每块等晕区分别指出其脉冲响应。如果仅讨论近轴的成像问题，则只要考虑系统轴上的等晕区就足够了。
> [!note] [等晕]([等晕条件 - 《中国大百科全书》第三版网络版 (zgbk.com)](https://www.zgbk.com/ecph/words?SiteID=1&ID=104768&SubID=95671))
> 1.假设物平面上$(\xi,\eta)$处有一个点光源，其数学表示为$\delta$函数。经过光学系统成像，在像平面上会出现它的像$h\left(x,y;\xi,\eta\right)$,称光学系统的脉冲响应。由于衍射效应和像差，脉冲响应不再是$\delta$函数，而是一个弥散斑，称*点扩散函数(PSF)*。
> 一些像差校正得很好的光学成像系统，当点光源在物面上移动时，像面的场分布(脉冲响应)只发生整体的位移，分布函数(弥散斑)的形式近似不变，可表达为：
> $$h\left(x,y;\xi,\eta\right)=h\left(x-\xi,y-\eta\right)$$
> 式 (1)称为“等晕条件”,满足式 (1)的系统称为线性空间不变系统。
> 2. 实际的光学系统并不符合线性空间不变条件，如一个视场较大的光学成像系统，不同视场的PSF差别不小，但总可以把物平面划分为许多小区域，在该小区域中系统近似满足线性空间不变条件，这样的区域称为“等晕”区。 图为一个焦距50毫米照相机物镜不同的视场（对最大视场归一化）：0视场（中心视场）、0.5、0.7和1视场（最大视场）的弥散斑图（又称点列图，简称SPT），可以看出不同视场的脉冲响应差别很大。在光学系统设计和成像质量评价中，需要考察不同视场的PSF。![[support/img/Pasted image 20240604133000.png|170]]

==首先要刨除"$\delta$函数的脉冲响应函数是一个固定的函数形式的概念, 在不同的地方, $\delta$函数会形成不同的像, 只有在'等晕'区之内, 才能说有空间不变的脉冲响应"==

---
联立以上$(1)(2)$两式, 得到
$$g(x,y)=\iint_{-\infty}^{\infty}f(\xi,\eta)h(x-\xi,y-\eta)\mathrm{d}\xi\mathrm{d}\eta=f(x,y)*h(x,y)\tag{3}$$
惊奇的发现, $函数f(x,y)经过系统作用, 其输出g就是f和脉冲响应的卷积$
其关键作用的是$h(x,y;\xi,\eta)=h(x-\xi,y-\eta)\tag{2}$正好使得满足了卷积的定义.
公式$(3)$被称“卷积积分”，它描述了线性不变系统的输入与输出间的变换特性。这个卷积积分的物理含义仍然是指：把输人函数 $（x，y）$分解为许多$\delta$函数的线性组合，每个脉冲都按其位置加权，然后把系统对于各个脉冲的响应叠加在一起就得出对于$f（x， y）$ 的整体响应。因此，式$(3)$仍然如式$(1)$那样反映了线性系统的叠加性质，==所不同的仅在于不论输人脉冲的位置如何，系统脉冲响应的函数形式均是相同的。因而系统的作用，可以用统一的一个脉冲响应函数来表征==，这种系统的分析就简单多了。另一方面，假如系统的输入-输出关系可由式（2-8）的卷积积分描述，就可以认为这个系统是线性不变系统。
### 2.2.2 线性不变系统的传递函数
对$(3)$式采用傅里叶**卷积定理**, 可以得到$$G(f_x,f_y)=F(f_x,f_y)H(f_x,f_y)\tag{4}$$
其中, 
- $F(f_{x},f_{y})=\mathscr{F}\{f(x,y)\}$, 称为*输入频谱*
- $G(f_{x},f_{y})=\mathscr{F}\{g(x,y)\}$, 称为*输出频谱*
-  $$H(f_{x},f_{y})=\iint_{-\infty}^{\infty}h(x,y)\exp[-\mathrm{j}2\pi(f_{x}x+f_{y}y)]\mathrm{d}x\mathrm{d}y=\mathscr{F}|h(x,y)|$$
	称为*传递函数或频率响应*
其作用为: ==决定了输入频谱中各种频率成分通过系统时将发生什么样的变化, 直接输入频谱×传递函数就得到了输出频谱.==
<u>得到了输出频谱我们能做什么呢?</u>可通**过傅里叶逆变换确定输出函数**本身
$$g(x,y)=\mathscr{F}^{-1}\{G(f_{x},f_{y})\mid=\mathscr{F}^{-1}\{F(f_{x},f_{y})H(f_{x},f_{y})\}$$
这样的好处是: 
> 从空间域人手直接计算系统的输出，要经过复杂的卷积积分运算，而在频率域仅是简单的代数运算。虽然除了乘法运算以外，还要做傅里叶正变换和逆变换运算，但只要熟悉傅里叶变换性质和有一个好的傅里叶变换对偶表，做这样的运算远比作卷积运算简单得多。因此，我们常常采用频率域分析方法，利用系统的传递函数来确定输出频谱，再经傅里叶逆变换，还原到空间域得到输出函数。这样处理，不仅简单，而且可以更深入地把握系统的物理实质。

#### (a)传递函数的物理意义
之前, 把**线性系统**的输入$f(x,y)$用$\delta$**函数**进行了拆分.
现在,对于**线性不变系统**, 使用**复指数函数**拆分效果更好.
- 观察傅里叶逆变换$f→F$
$$f(x,y)=\iint_{-\infty}^{\infty}F(f_{x},f_{y})\exp[\mathrm{j}2\pi(f_{x}x+f_{y}y)]\mathrm{d}f_{x}\mathrm{d}f_{y}$$
这个式子表明,函数$f(x,y)$可以看做许多不同空间频率的复指数函数的线性组合, 权重为$F(f_x,f_y)$. 这种方法称为*傅里叶分解*.
- 添加系统算符
$$\begin{aligned}g(x,y)&=\mathscr{L}|f(x,y)|\\&=\mathscr{L}\Big\{\iint_{-\infty}^{\infty}F(f_{x},f_{y})\exp\bigl[\mathrm{j}2\pi(f_{x}x+f_{y}y)\bigr]\mathrm{d}f_{x}\mathrm{d}f_{y}\Big\}\end{aligned}$$
- 根据线性叠加, 系统作用算符弄进去
$$g(x,y)=\iint_{-\infty}^{\infty}F(f_{x},f_{y})\mathscr{L}\{\exp[j2\pi(f_{x}x+f_{y}y)]\}\mathrm{d}f_{x}\mathrm{d}f_{y}\tag{5}$$
- 另一方面, 对输出函数进行傅里叶分解
$$g(x,y)=\iint_{-\infty}^{\infty}G(f_x,f_y)\exp[\mathrm{j}2\pi(f_xx+f_yy)]\mathrm{d}f_x\mathrm{d}f_y\tag{6}$$
- 把$(4)$带入$(6)$中, 得到$$g(x,y)=\iint_{-\infty}^{\infty}F(f_{x},f_{y})H(f_{x},f_{y})\exp[\mathrm{j}2\pi(f_{x}x+f_{y}y)]\mathrm{d}f_{x}\mathrm{d}f_{y}\tag{7}$$
- 对比$(5)(7)$两式得到$$\mathscr{L}|\exp[\mathrm{j}2\pi(f_{x}x+f_{y}y)]]=H(f_{x},f_{y})\exp[\mathrm{j}2\pi(f_{x}x+f_{y}y)]\tag{8}$$
上式说明, ==基元复指数函数, 经过线性不变系统的作用之后, 还是同频率的复指数函数, 但是可能产生与频率有关的幅值变化和相移.变化取决于系统的传递函数.==
### 2.2.3线性不变系统的本征函数
*本征函数*的定义: 对于线性不变系统，输人某一函数，如果相应的输出函数仅等于输入函数与一个复比例常数的乘积，这个输人函数就称为这种系统的本征函数。用公式表达为$$\mathscr{L}\{f(x,y;f_a,f_b)\}=H(f_a,f_b)f(x,y;f_a,f_b)\tag{9}$$
其中,
- $f(x,y;f_a,f_b)$是输入函数, 也是该系统的本征函数
- $H(f_{a},f_{b})$为复比例常数, 称为本征函数$f$的本征值
**显然，一个线性不变系统的本征函数，通过系统时不改变其函数形式，而仅仅可能被衰减或放大，以及产生相移。其变化量取决于相应本征值。** 根据这个定义, 观察式$(8)$, 则==复指数函数式线性不变系统的本征函数==.
---
证明如下(内容:复指数函数式线性不变系统的本征函数, 之前式$8$是因为左右对起来的)
- 输入函数$$f(x,y)=\exp[j2\pi(f_{a}x+f_{b}y)]\tag{10}$$
- 根据傅里叶变换, 得到频谱为$$F(f_x,f_y)=\delta(f_x-f_a,f_y-f_b)\tag{11}$$
- 由于是线性不变系统, 因此输出的频谱是$$\begin{aligned}
g(x,y)& =\mathscr{F}^{-1}\mid G(f_{x},f_{y})\mid   \\
& =\mathscr{F}^{-1}\mid H(f_{a},f_{b})\delta(f_{x}-f_{a},f_{y}-f_{b})\mid   \\
&=H(f_{a},f_{b})\exp[\mathrm{j}2\pi(f_{a}x+f_{b}y)]
\end{aligned}\tag{12}$$
- 联立$(10)(12)$得到$$\mathscr{L}|\exp[\mathrm{j}2\pi(f_ax+f_by)]|=H(f_a,f_b)\exp[\mathrm{j}2\pi(f_ax+f_by)]$$
得证
> 本征值是各种频率的函数, 也是系统用的传递函数(频率响应)
---
#### 2.2.3.1脉冲响应是实函数的线性不变系统
==这种系统可以把一个实值输入变换为一个实值输出, 非常常见, 例如: 非相关成像系统.==
这类系统传递函数$H(f_x,f_y)$是厄米的==**(咋证明啊)**==，即有
$$H(f_x,f_y)\:=\:H^*\:(\:-f_x,\:-f_y)\tag{13}$$
用$A(f_{x},f_{y})$和$\phi(f_{x,f_{y}})$表示传递函数的模和幅角, 分别称之为*振幅传递函数*和*相位传递函数*, 则$H$可以表示为$$H(f_x,f_y)=A(f_x,f_y)\exp[-\mathrm{j}\phi(f_x,f_y)]\tag{14}$$, 而$$H^*(-f_x,-f_y)=A(-f_x,-f_y)\exp[\mathrm{~j}\phi(-f_x,-f_y)]$$
由于是厄米的, 因此, $$A(f_x,f_y)\exp[-\mathrm{j}\phi(f_x,f_y)]=A(-f_x,-f_y)\exp[\mathrm{j}\phi(-f_x,-f_y)]$$
因此必然有( ==**为啥啊**== )$$\begin{aligned}A(f_{x},f_{y})=A(-f_{x},-f_{y})\\-\phi(f_{x},f_{y})=\phi(-f_{x},-f_{y})\end{aligned}\tag{15}$$
这表明**振幅传递函数是偶函数, 相位传递函数是奇函数**.

---
**证明余弦函数是这类系统的本征函数:** 
传递函数为$H(f_{x},f_{y})$,输入函数
$f( x, y)$ = $\cos [$ $2\pi ( f_ax+ f_by)$ ]

$$f(x,y)=\cos[2\pi(f_{a}x+f_{b}y)]$$输人频谱为(余弦函数的F变换)$$F(f_x,f_y)=\frac{1}{2}[\delta(f_x-f_a,f_y-f_b)+\delta(f_x+f_a,f_y+f_b)]$$线性不变系统的输出频谱为$$\begin{aligned}G(f_{x},f_{y})&=H(f_{x},f_{y})F(f_{x},f_{y})\\&=\frac{1}{2}H(f_{a},f_{b})\delta(f_{x}-f_{a},f_{y}-f_{b})+\frac12H(-f_a,-f_b)\delta(f_x+f_a,f_y+f_b)\end{aligned}$$
系统的输出为$$\begin{aligned}g(x,y)&=\mathscr{F}^{-1}\mid G(f_{x},f_{y})\mid\\&=\frac{1}{2}H(f_{a},f_{b})\exp[\mathrm{j}2\pi(f_{a}x+f_{b}y)]+\\&\frac{1}{2}H(-f_{a},-f_{b})\exp[-\mathrm{j}2\pi(f_{a}x+f_{b}y)]\end{aligned}$$根据式$(15)$可以把上式写为$$\begin{aligned}g(x,y)&=\frac{1}{2}A(f_{a},f_{b})\exp[\mathrm{j}2\pi(f_{a}x+f_{b}y)-\mathrm{j}\phi(f_{a},f_{b})]+\\&\frac{1}{2}A(f_{a},f_{b})\exp[-\mathrm{j}2\pi(f_{a}x+f_{b}y)+\mathrm{j}\phi(f_{a},f_{b})]\\&=A(f_{a},f_{b})\cos[2\pi(f_{a}x+f_{b}y)-\phi(f_{a},f_{b})]\end{aligned}$$
因此有$$\mathscr{L}\{\cos[2\pi(f_ax+f_by)]\}=A(f_a,f_b)\cos[2\pi(f_ax+f_by)-\phi(f_a,f_b)]$$
由于频率是任意实数$(f_{x},f_{y})$, 则上式可以改写为$$\mathscr{L}\{\cos[2\pi(f_{x}x+f_{y}y)]\}=A(f_{x},f_{y})\cos[2\pi(f_{x}x+f_{y}y)-\phi(f_{x},f_{y})]$$
得证 ^4c46ec

>事实上，为了检验一个系统是不是线性不变的，只要输人一个余弦信号， 然后考察其输出中是否包含其他频率成分。如果除了输入频率的余弦信号之外， 还包含其他频率的余弦信号，则系统不是线性不变的。对于线性不变系统，测量传递函数的直接方法是对系统输入不同频率的正（余）弦信号，并测量输出的振幅衰减或增益以及相移，从而得到振幅传递函数和相位传递函数在相应频率处的值。虽然输入到系统的并非总是复指数函数、正（余）弦函数，但是可以根据系统的物理本质，把输人函数分解为适当的本征函数的线性组合。由于本征函数通过系统时，函数形式不变，讨论起来十分方便。不同频率的本征函数其幅度和相位的变化量取决于相应频率的本征值，即传递函数在该频率处的数值。 所有受到传递函数影响而发生幅度或相位变化的本征函数在输出平面的线性组合．给出系统的输出。

### 2.2.4 线性不变系统作为滤波器
由于输入频谱和输出频谱满足$$G(f_x,f_y)=F(f_x,f_y)H(f_x,f_y)\tag{16}$$
系统改变了输人函数频谱。==因此，线性不变系统的功能类似于一种滤波器，它使某些频率分量被滤除，某些频率分量通过，在通过系统的各频率分量之间还可能引入与频率有关的衰减和相移。==系统的滤波特性取决于系统对答种频率分量的响应即传递函数。![[support/img/Pasted image 20240604175940.png|431]]
#### (a)理想状态
从信息传递的角度来看(其实是胡扯), 要求输出函数尽可能逼近输入函数, 也就是对于输入为$f(x,y)$, 输出为(前提)$$g(x,y)=kf(x-\xi,y-\eta)\tag{17}$$
式中，$\xi、\eta 为实常数，通常 0<k\leq1 表示常数衰减。若输人频谱为 F (f_x,f_y)$
由傅里叶变换的位移定理，输出频谱为$$G(f_{x},f_{y})=kF(f_{x},f_{y})\exp[-\mathrm{j}2\pi(f_{x}\xi+f_{y}\eta)]$$
因此系统的传递函数为$$H(f_{x},f_{y})=k\mathrm{exp}[-\mathrm{j}2\pi(f_{x}\xi+f_{y}\eta)]$$
这表明要求: 输人函数所包含的所有频率分量在通过系统时被同等衰减，因而相对强度保持不变。同时，它们还受到正比于频率的线性相移。
脉冲响应为$$h(x,y)=\mathscr{F}^{-1}\{H(f_{x},f_{y})\}=k\delta(x-\xi,y-\eta)$$
这表明系统对脉冲输入的响应仍然是脉冲函数. 可以证明, 此时系统的输出满足理想状况$(17)$.
于是，所有经同等衰减和线性相移的频率分量叠加起来给出的总响应，**==除了衰减和平移以外，可看作是输人函数的准确复现。==** 这种系统可认为是无畸变滤波器。
然而，这样的系统实际上并不存在，它仅仅是一种理想化的模型。例如， 使点物成点像，从而像与物完全相同的成像系统仅仅是几何光学的理想情况， **并没有考虑由于孔径有限大小所造成的衍射效应，限制了系统的分辨能力**，不可能传递物体全部细节。实际的物理系统常常会引起振幅和位相畸变，输出将不再是输入的准确复现，即产生畸变或失真。假若系统对于输入的各频率分量产生均匀的位相延迟，仅改变其相对的振幅大小，这种系统可看作是*振幅滤波器*。假若系统对于输入的各频率分量产生均匀的振幅衰减，仅改变相对的位相分布，这种系统可看作是*位相滤波器*。前面提到的产生==**线性相移的滤波器**==，也可以看作是无畸变的位相滤波器。实际系统常常是两种滤波器的组合，但**我们可以分别考虑振幅传递函数和相位传递函数的作用**。
#### (b)振幅滤波器
图2-7中给出几种一维振幅滤波器的例子。其中图2-7a 是无畸变振幅滤波器， 或称全通滤波器。不论频率多高的频率分量都可以无畸变通过系统，这在物理上是不能实现的。我们遇到的实际系统常常是图2-7b所示的低通滤波器，它只允许通过 （衰减或不衰减）频率低于某一上限的频率分量，这个频率上限称为系统的截止频率。超过这一极限值的频率分量被系统完全滤除。光学成像系统不论在相干还是非相干照明情况下，都表现出低通滤波器的性质。图2-7c所示为高通滤波器，它可以传递频率高于某一特定值的一切频率分量，而滤除低于它的一切成分。这也是一种理想化情况。图2-7d所示为带通滤波器，它允许通过某特定频带内的频率分量而滤除其他成分。![[support/img/Pasted image 20240604181739.png|132]]
#### (c)位相滤波器
对于位相滤波器，当相位传递函数不是频率的线性函数时，系统一般就将引人位相畸变。**即使所有频率分量都毫无衰减地传递到输出平面，由于相位传递函数的影响，各频率分量之间产生相对相移，输出也可能大大偏离输人而发生严重畸变。**

### 2.2.5级联系统
**问题: 两个前后相连的线性不变系统是否可以用一个总的系统来等效.**
![[support/img/Pasted image 20240604182157.png]]
对于总的系统, 输入为$f_{1}(x,y)$, 输出为$f_{2}(x,y)$.则有$$\begin{aligned}&f_{2}(x,y)=g_{1}(x,y)=f_{1}(x,y)*h_{1}(x,y)\\&g_{2}(x,y)=f_{2}(x,y)*h_{2}(x,y)\end{aligned}$$
上式代入下式, 根据卷积的**结合律**有
$$\begin{aligned}g_{2}(x,y)&=\begin{bmatrix}f_1(x,y)*h_1(x,y)\end{bmatrix}*h_2(x,y)\\&=f_1(x,y)*\begin{bmatrix}h_1(x,y)*h_2(x,y)\end{bmatrix}\end{aligned}$$
这表明, 总的系统仍是空间不变的线性系统. 总的脉冲响应为$$h(x,y)=h_1(x,y)*h_2(x,y)$$
如果$H_{1}和H_{2}$分别表示级联的两个系统的传递函数, 则总的传递函数为$$H(f_x,f_y)=H_1(f_x,f_y)\cdot H_2(f_x,f_y)\tag{12}$$
最终的频谱为$$\begin{aligned}
G_{2}(f_{x},f_{y})& =F_{1}\left(f_{x},f_{y}\right)H\left(f_{x},f_{y}\right)  \\
&=F_1(f_x,f_y)\cdot\left[H_1(f_x,f_y)\cdot H_2(f_x,f_y)\right]
\end{aligned}$$
- 推广到**n级级联**则有$$h(x,y)=h_{1}(x,y)*h_{2}(x,y)*\cdots*h_{n}(x,y)$$$$H(f_{x},f_{y})=H_{1}(f_{x},f_{y})\cdot H_{2}(f_{x},f_{y})\cdot\cdots\cdot H_{n}(f_{x},f_{y})$$由于卷积和乘法运算都符合交换律和结合律，**计算时可以不按级联次序，而依照方便决定先后顺序。** 
若传递函数用它的模和辐角表示，即
$$H(f_x,f_y)=A(f_x,f_y)\exp[-\mathrm{j}\phi(f_x,f_y)]$$

代入公式$(18)$, 得到总的振幅传递函数和相位传递函数分别为$$A(f_{x},f_{y})=A_{1}(f_{x},f_{y})\cdot A_{2}(f_{x},f_{y})\cdot\cdots\cdot A_{n}(f_{x},f_{y})$$$$\phi(f_{x},f_{y})=\phi_{1}(f_{x},f_{y})+\phi_{2}(f_{x},f_{y})+\cdots+\phi_{n}(f_{x},f_{y})$$
### 2.2.6 线响应和直边响应
#👁 
## 2.3抽样定理
在实现信息记录、存储、发送和处理时，由于物理器件有限的信息容量， 一个连续函数往往要用它在一些分立的取样点上的函数值，即抽样值来表示。例如，用探测器阵列记录某平面上的光强分布。如何选择探测单元之间的间隔 （抽样间隔），以便做到既不丢失信息，又不对探测阵列本身提出过分的要求。 是否能由这些抽样值，恢复一个连续函数？这些正是抽样定理所要回答的问题。
### 2.3.1 函数的抽样
利用$comb$函数对连续函数$g(x,y)$抽样, 得到$$g_s(x,y)=\mathrm{comb}\Big(\frac{x}{X}\Big)\mathrm{comb}\Big(\frac{y}{Y}\Big)g(x,y)$$
抽样函数$g_{s}$由$\delta$函数的阵列构成，各个空间脉冲在$x$方向和$y$方向的间距分别为$X$ 和$Y$。每个$\delta$ 函数下的体积正比于该点 $g$ 的函数值。利用卷积定理，抽样函数$g_{s}$的频谱为$$\begin{aligned}
&G_s(f_x,f_y)&&=\mathscr{F}\Big\{\mathrm{comb}\Big(\frac xX\Big)\mathrm{comb}\Big(\frac yY\Big)\Big\}*G(f_x,f_y)  \\
&&& =XY\mathrm{comb}(Xf_x)\mathrm{comb}(Yf_y)*G(f_x,f_y)  \\
&&&=\sum_{n=-\infty}^{\infty}\sum_{m=-\infty}^{\infty}\delta\Big(f_{x}-\frac{n}{X},f_{y}-\frac{m}{Y}\Big)*G(f_{x},f_{y}) \\
&&& =\sum_{n=-\infty}^{\infty}\sum_{m=-\infty}^{\infty}G\Big(f_{x}-\frac nX,f_{y}-\frac mY\Big) 
\end{aligned}$$
这个式子说明, 空间域中, 函数周期性的抽样不同值, 在频谱域使得函数的频谱$G$周期性复现, 其中新为$\left(\frac nX,\frac mY\right)$
![[support/img/Pasted image 20240604221650.png|293]]
假定$g(x,y)$是限带函数，其频谱仅在频率平面一个有限区域$\mathscr{B}$上不为零。若 2$B_{{x}}$和 2$B_{{y}}$分别表示包围$\mathscr{R}$的最小矩形在$f_{x}$和$f_{y}$方向上的宽度，则只要
$$\frac1X\geqslant2B_x,\frac1Y\geqslant2B_y$$或写为$$X\leqslant\frac1{2B_x},Y\leqslant\frac1{2B_y}$$
这样就避免了频谱混叠.频带越大, 抽样间隔应该越小.这杯称为*Nyquist间隔.*

### 2.3.2函数的还原
原理如下图![[support/img/Pasted image 20240604222307.png|431]]
选择矩形函数作为滤波函数,即$$H(f_x,f_y)=\mathrm{rect}\Big(\frac{f_x}{2B_x}\Big)\mathrm{rect}\Big(\frac{f_y}{2B_y}\Big)$$
则$G_{s}$→$G$为
$$G(f_x,f_y)=G_s(f_x,f_y)\operatorname{rect}\biggl(\frac{f_x}{2B_x}\biggr)\operatorname{rect}\biggl(\frac{f_y}{2B_y}\biggr)$$
对应的空间域为$$g(x,y)=g_s(x,y)*h(x,y)\tag{19}$$
其中, 
-  $$\begin{aligned}
g_{s}(x,y)& =\mathrm{comb}\Big(\frac{x}{X}\Big)\mathrm{comb}\Big(\frac{y}{Y}\Big)g(x,y)  \\
&&\ \\
&=XY\sum_{n=-\infty}^{\infty}\sum_{m=-\infty}^{\infty}g\left(nX,mY\right)\delta(x-nX,y-mY)
\end{aligned}$$
$$h(x,y)=\mathscr{F}\Big\{\operatorname{rect}\Big(\frac{f_x}{2B_x}\Big)\operatorname{rect}\Big(\frac{f_y}{2B_y}\Big)\Big\}=4B_xB_y\operatorname{sinc}(2B_xx)\operatorname{sinc}(2B_yy)$$
将以上两个式子带入$(19)$中, 则有$$\begin{aligned}&g(x,y)=4B_xB_yXY\sum_{n=-\infty}^\infty \sum_{n=-\infty}^\infty g(nX,mY)\operatorname{sinc}[2B_x(x-nX)]\operatorname{sinc}[2B_y(y-mY)]\end{aligned}$$
采取允许的最大抽样间隔, 即$X=\frac{1}{2B_{X}},Y=\frac{1}{2B_{y}}$, 则$$\begin{aligned}&g(x,y)\\&=\sum_{n=-\infty}^\infty\sum_{m=-\infty}^\infty g\Big(\frac n{2B_x},\frac m{2B_y}\Big)\mathrm{sinc}\Big[2B_x\Big(x-\frac n{2B_x}\Big)\Big]\mathrm{sinc}\Big[2B_y\Big(y-\frac m{2B_y}\Big)\Big]\end{aligned}\tag{20}$$
这样就证明了：只要抽样间隔满足Nyquist条件，就可以准确还原一个限带的连续函数。办法是在每一个抽样点上放置一个==以抽样值权重的 sinc 函数作为内插函数==，由这些 sine函数的线性组合可复原原函数。公式$(20)$称为*惠特克-香农（Whittaker-Shannon）* 抽样定理。当然，若不选择方形的抽样格点，或选择别种滤波函数，将导出其他形式的抽样定理。

==抽样定理给出一个重要结论：一个连续的限带函数可由其离散的抽样序列代替，而并不丢失任何信息。==换句话说，这个连续函数具有的信息内容等效于一些离散的信息抽样。抽样定理指出了重新产生连续函数所必须的离散值的最低数目，以及由抽样值恢复原函数的方法，即在空域插值或在频域滤波的方法。 严格说来，**频带有限的函数在物理上并不存在**，例如光学中涉及到的光分布，仅存在于有限的空间范围内，属非周期函数，其频率范围可能扩展到无穷。 但这些函数的频谱随着频率高到一定程度，总是大大减小的。大部分能量总是由一定频率范围内的分量所携带。**实际应用时，可以把它们近似看作限带函数， 而忽略高频分量引入的误差。**

### 2.3.3 空间带宽积
若限带函数$g(x,y)$在频域$|f_x|\leqslant B_x$、$|f_y|\leqslant B_y$以外恒等于零，考虑函数在空域|$x|\leq X$、| $y|\leq Y$的区间上抽样数目最少应为
$$( \frac {2X}{1/ ( 2B_{{_{x}}}) }) ( \frac {2Y}{1/ ( 2B_{{_{y}}}) }) = ( 4XY) ( 4B_{{_{* }}}B_{{_{y}}}) = 16XYB_{{_{x}}}B_{{_{y}}}$$
式中，4XY表示函数在空域中的面积；4$B_{_{_{x}}}B_{_{_{y}}}$表示函数在频域中的面积。在该区间，函数可由数目为 16$XYB_xB_y$个抽样值来近似表示。当然，这只是一种近似。根据抽样定理，$xy$平面上任一点的准确的函数值应等于整个空间域所有抽样点上内插的 sinc 函数在该点的贡献之和。由于 sinc 函数衰减很快，离该点足够远的位置上的 sinc函数的贡献趋于零。因而在一定精度内，只需要该点周围有限效目的抽样值就可近似确定这一点的函数值。
*空间带宽积*$SW$就定义为函数在空域和频域中所占面积之积，即$$SW=16XYB_xB_y$$
其意义为 **: 它不仅用来描述空间信号（如图像、光学像）的信息容量，也可用来描述成像系统、信息处理系统的信息传递或处理能力。例如，成像系统的空间带宽积就等于有效视场和由系统截止频率所确定的通带面积的乘积。** 图2-14给出一维空间带宽积的图示， 当函数在空间位移或产生频移时，SW 不变。若空间大小变化，带宽依反比关系变化，SW 仍具有不变性。所以，假如没有外来因素的限制，物体的空间带宽积具有不变性，或者说物体的信息容量是不变的。当物体信息经由系统传递或处理时， 为了不损失信息，系统的SW 应大于物体本身的SW。当然，系统SW越大，设计和制造越困难。![[support/img/Pasted image 20240604223947.png|247]]

# 第三章

